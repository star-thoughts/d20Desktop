<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:Fiction.GameScreen"
                    xmlns:comp="clr-namespace:System.ComponentModel;assembly=WindowsBase"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib"
                    xmlns:resources="clr-namespace:Fiction.GameScreen.Resources"
                    xmlns:controls="clr-namespace:Fiction.GameScreen.Controls"
                    xmlns:windows="clr-namespace:Fiction.Windows;assembly=Fiction.Windows"
                    xmlns:combat="clr-namespace:Fiction.GameScreen.Combat;assembly=Fiction.GameScreen"
                    xmlns:monsterStats="clr-namespace:Fiction.GameScreen.ViewModels.EditMonsterViewModels"
                    xmlns:monsters="clr-namespace:Fiction.GameScreen.Monsters;assembly=Fiction.GameScreen"
                    xmlns:players="clr-namespace:Fiction.GameScreen.Players;assembly=Fiction.GameScreen"
                    xmlns:spells="clr-namespace:Fiction.GameScreen.Spells;assembly=Fiction.GameScreen"
                    xmlns:vm="clr-namespace:Fiction.GameScreen.ViewModels"
                    xmlns:equipment="clr-namespace:Fiction.GameScreen.Equipment;assembly=Fiction.GameScreen"
                    xmlns:vmresources="clr-namespace:Fiction.GameScreen.Resources"
                    xmlns:diag="clr-namespace:System.Diagnostics;assembly=WindowsBase">
    <!--  Converters  -->
    <BooleanToVisibilityConverter x:Key="BooleanToVisibility" />
    <windows:ReferenceToBooleanConverter x:Key="ReferenceToBoolean" />
    <windows:ReferenceToVisibilityConverter x:Key="ReferenceToVisibility" />
    <controls:NameToFirstLetterConverter x:Key="NameGroupingConverter" />
    <controls:MonsterToViewModelConverter x:Key="MonsterConverter" />
    <windows:StringJoinConverter x:Key="StringJoinConverter" />
    <windows:TestConverter x:Key="TestConverter" />
    <controls:CampaignObjectConverter x:Key="CampaignObjectConverter" />
    <controls:MonetaryConverter x:Key="MonetaryConverter" />
    <windows:BooleanReverseConverter x:Key="BooleanReverseConverter" />
    <controls:DamageReductionConverter x:Key="DamageReductionConverter" />
    <controls:CharacterAlignmentConverter x:Key="AlignmentConverter" />

    <!--  Constants  -->
    <sys:Double x:Key="{x:Static controls:ResourceKeys.HeaderFontSize}">28</sys:Double>
    <sys:Double x:Key="{x:Static controls:ResourceKeys.SubheaderFontSize}">20</sys:Double>
    <sys:Double x:Key="{x:Static controls:ResourceKeys.TextFontSize}">16</sys:Double>
    <SolidColorBrush x:Key="{x:Static controls:ResourceKeys.HeaderFontColor}"
                     Color="LightBlue" />
    <SolidColorBrush x:Key="{x:Static controls:ResourceKeys.TextFontColor}"
                     Color="White" />
    <LinearGradientBrush x:Key="{x:Static controls:ResourceKeys.FadeToRightBrush}"
                         StartPoint="0,0"
                         EndPoint="1,0">
        <GradientStop Offset="0.0"
                      Color="LightBlue" />
        <GradientStop Offset="1.0"
                      Color="Transparent" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="{x:Static controls:ResourceKeys.FadeToLeftBrush}"
                         StartPoint="0,0"
                         EndPoint="1,0">
        <GradientStop Offset="0.0"
                      Color="Transparent" />
        <GradientStop Offset="1.0"
                      Color="LightBlue" />
    </LinearGradientBrush>
    <LinearGradientBrush x:Key="{x:Static controls:ResourceKeys.FadeFromCenterBrush}"
                         StartPoint="0, 0"
                         EndPoint="1, 1">
        <GradientStop Offset="0.0"
                      Color="Transparent" />
        <GradientStop Offset="0.5"
                      Color="LightBlue" />
        <GradientStop Offset="1.0"
                      Color="Transparent" />
    </LinearGradientBrush>
    <!--  Style for grid splitters that split controls vertically  -->
    <Style x:Key="{x:Static controls:ResourceKeys.VerticalSplitterStyle}"
           TargetType="{x:Type GridSplitter}">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="HorizontalAlignment"
                Value="Stretch" />
        <Setter Property="VerticalAlignment"
                Value="Top" />
        <Setter Property="Height"
                Value="4" />
    </Style>
    <!--  Style for grid splitters that split controls horizontally  -->
    <Style x:Key="{x:Static controls:ResourceKeys.HorizontalSplitterStyle}"
           TargetType="{x:Type GridSplitter}">
        <Setter Property="Background"
                Value="Transparent" />
        <Setter Property="HorizontalAlignment"
                Value="Left" />
        <Setter Property="VerticalAlignment"
                Value="Stretch" />
        <Setter Property="Width"
                Value="4" />
    </Style>
    <!--  ListBoxItem Default Style  -->
    <Style TargetType="{x:Type ListBoxItem}"
           BasedOn="{StaticResource {x:Type ListBoxItem}}"
           x:Key="{x:Static controls:ResourceKeys.ListBoxItemStyle}">
        <Setter Property="HorizontalContentAlignment"
                Value="Stretch" />
        <Setter Property="Padding"
                Value="4, 0" />
        <Style.Triggers>
            <DataTrigger Binding="{Binding Source={x:Static local:App.Current}, Path=AppSettings.IsTouchEnabled}"
                         Value="True">
                <Setter Property="Padding"
                        Value="4" />
            </DataTrigger>
        </Style.Triggers>
    </Style>


    <!--  General Controls  -->

    <!--  Add/Remove/Edit Control  -->
    <Style TargetType="{x:Type controls:AddRemoveEdit}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Orientation"
                Value="Horizontal" />
        <Setter Property="HorizontalContentAlignment"
                Value="Right" />
        <Setter Property="VerticalContentAlignment"
                Value="Center" />
        <Setter Property="AllowAdd"
                Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:AddRemoveEdit}">
                    <Border BorderBrush="{x:Null}"
                            BorderThickness="1"
                            Background="{TemplateBinding Background}">
                        <StackPanel Orientation="{TemplateBinding Orientation}"
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                            <Button Content="{Binding Source={x:Static resources:Resources.AddButton}}"
                                    Margin="4"
                                    FontFamily="Segoe UI Symbol"
                                    Command="local:Commands.Add"
                                    Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=AllowAdd, Converter={StaticResource BooleanToVisibility}}"
                                    ToolTip="{Binding Source={x:Static resources:Resources.AddButtonToolTip}}" />
                            <Button Content="{Binding Source={x:Static resources:Resources.RemoveButton}}"
                                    Margin="4"
                                    FontFamily="Segoe UI Symbol"
                                    Command="local:Commands.Remove"
                                    CommandParameter="{TemplateBinding CommandParameter}"
                                    ToolTip="{Binding Source={x:Static resources:Resources.RemoveButtonToolTip}}" />
                            <Button Content="{Binding Source={x:Static resources:Resources.EditButton}}"
                                    Margin="4"
                                    Command="local:Commands.Edit"
                                    FontFamily="Segoe UI Symbol"
                                    CommandParameter="{TemplateBinding CommandParameter}"
                                    Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=AllowEdit, Converter={StaticResource BooleanToVisibility}}"
                                    ToolTip="{Binding Source={x:Static resources:Resources.EditButtonToolTip}}" />
                            <Button Content="{Binding Source={x:Static resources:Resources.CopyButton}}"
                                    Margin="4"
                                    Command="local:Commands.CreateCopy"
                                    CommandParameter="{TemplateBinding CommandParameter}"
                                    FontFamily="Segoe UI Symbol"
                                    Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=AllowCopy, Converter={StaticResource BooleanToVisibility}}"
                                    ToolTip="{Binding Source={x:Static resources:Resources.CopyButtonToolTip}}" />
                        </StackPanel>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  Popup replacement for ContextMenu  -->
    <Style TargetType="{x:Type controls:ContextPopup}">
        <Setter Property="DataContext"
                Value="{Binding RelativeSource={RelativeSource Self}, Path=PlacementTarget.DataContext}" />
        <Setter Property="Content"
                Value="{Binding}" />
        <Setter Property="SnapsToDevicePixels"
                Value="True" />
        <Setter Property="Grid.IsSharedSizeScope"
                Value="True" />
        <Setter Property="HasDropShadow"
                Value="True" />
        <Setter Property="Background"
                Value="LightGray" />
        <Setter Property="TextElement.Foreground"
                Value="Black" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ContextPopup}">
                    <Border x:Name="Border"
                            BorderThickness="1"
                            BorderBrush="White"
                            Background="{TemplateBinding Background}">
                        <Grid Margin="4">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <ContentPresenter Content="{TemplateBinding Content}"
                                              ContentTemplate="{TemplateBinding ContentTemplate}"
                                              ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}" />
                            <StackPanel Grid.Row="1"
                                        IsItemsHost="True"
                                        KeyboardNavigation.DirectionalNavigation="Cycle" />
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="HasDropShadow"
                                 Value="true">
                            <Setter TargetName="Border"
                                    Property="Padding"
                                    Value="0,3,0,3" />
                            <Setter TargetName="Border"
                                    Property="CornerRadius"
                                    Value="4" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  Data Templates -->
    <DataTemplate x:Key="{x:Static controls:ResourceKeys.CombatantPreparerViewTemplate}">
        <ScrollViewer Grid.Row="1"
                      HorizontalScrollBarVisibility="Disabled"
                      VerticalScrollBarVisibility="Auto"
                      PanningMode="VerticalOnly">
            <Grid x:Name="PART_InputPanel">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="4" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Row="0"
                           Grid.Column="0"
                           Text="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                <TextBlock Grid.Row="0"
                           Grid.Column="2"
                           Text="{Binding Name}" />
                <CheckBox Grid.Row="1"
                          Grid.Column="2"
                          IsEnabled="False"
                          Content="{Binding Source={x:Static resources:Resources.DisplayToPlayersLabel}}"
                          IsChecked="{Binding DisplayToPlayers}" />
                <TextBlock Grid.Row="2"
                           Grid.Column="0"
                           Text="{Binding Source={x:Static resources:Resources.DisplayNameLabel}}" />
                <TextBlock Grid.Row="2"
                           Grid.Column="2"
                           Text="{Binding DisplayName}" />
                <Border Grid.Row="3"
                        Grid.ColumnSpan="3"
                        BorderThickness="0,0,0,2"
                        BorderBrush="{StaticResource {x:Static controls:ResourceKeys.FadeToLeftBrush}}" />
                <TextBlock Grid.Row="4"
                           Grid.Column="0"
                           Text="{Binding Source={x:Static resources:Resources.HitDiceLabel}}" />
                <TextBlock Grid.Row="4"
                           Grid.Column="2"
                           Text="{Binding HitDieString}" />
                <TextBlock Grid.Row="5"
                           Grid.Column="0"
                           Text="{Binding Source={x:Static resources:Resources.RollingStrategyLabel}}" />
                <TextBlock Grid.Row="5"
                           Grid.Column="2"
                           Text="{Binding HitDiceStrategy}" />
                <TextBlock Grid.Row="6"
                           Grid.Column="0"
                           Text="{Binding Source={x:Static resources:Resources.MaxHitPointsLabel}}" />
                <TextBlock Grid.Row="6"
                           Grid.Column="2"
                           Text="{Binding HitPoints}" />
                <TextBlock Grid.Row="7"
                           Grid.Column="0"
                           Text="{Binding Source={x:Static resources:Resources.FastHealingLabel}}" />
                <TextBlock Grid.Row="7"
                           Grid.Column="2"
                           Text="{Binding FastHealing}" />
                <Border Grid.Row="8"
                        Grid.ColumnSpan="3"
                        BorderThickness="0,0,0,2"
                        BorderBrush="{StaticResource {x:Static controls:ResourceKeys.FadeToLeftBrush}}" />
                <TextBlock Grid.Row="9"
                           Grid.Column="0"
                           Text="{Binding Source={x:Static resources:Resources.InitiativeRollLabel}}" />
                <TextBlock Grid.Row="9"
                           Grid.Column="2"
                           Text="{Binding InitiativeRoll}" />
                <TextBlock Grid.Row="10"
                           Grid.Column="0"
                           Text="{Binding Source={x:Static resources:Resources.InitiativeModifierLabel}}" />
                <TextBlock Grid.Row="10"
                           Grid.Column="2"
                           Text="{Binding InitiativeModifier}" />
                <TextBlock Grid.Row="11"
                           Grid.Column="0"
                           Text="{Binding Source={x:Static resources:Resources.InitiativeTotalLabel}}" />
                <TextBlock Grid.Row="11"
                           Grid.Column="2"
                           x:Name="PART_InitiativeTotal"
                           Text="{Binding InitiativeTotal}" />
            </Grid>
        </ScrollViewer>
    </DataTemplate>

    <DataTemplate x:Key="{x:Static controls:ResourceKeys.EffectNameTemplate}">
        <Grid Background="Transparent">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Text="{Binding Name}"
                       TextTrimming="CharacterEllipsis" />
            <TextBlock Grid.Column="1"
                       x:Name="SourceText">
                <Run Text="(" /> <Run Text="{Binding Source.Name}" /> <Run Text=")" />
            </TextBlock>
            <Grid.ContextMenu>
                <ContextMenu DataContext="{Binding RelativeSource={RelativeSource Self}, Path=PlacementTarget.DataContext}">
                    <MenuItem Header="{Binding Source={x:Static resources:Resources.RemoveTargetMenuHeader}}"
                              Command="local:Commands.RemoveTarget"
                              CommandParameter="{Binding}" />
                    <MenuItem Header="{Binding Source={x:Static resources:Resources.RemoveEffectMenuHeader}}"
                              Command="local:Commands.Remove"
                              CommandParameter="{Binding}" />
                </ContextMenu>
            </Grid.ContextMenu>
            <Grid.ToolTip>
                <ToolTip DataContext="{Binding RelativeSource={RelativeSource Self}, Path=PlacementTarget.DataContext}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Label Grid.Row="0"
                               Grid.Column="0"
                               Padding="4, 0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                        <TextBlock Grid.Row="0"
                                   Grid.Column="1"
                                   VerticalAlignment="Center"
                                   Text="{Binding Path=Name}" />
                        <Label Grid.Row="1"
                               Grid.Column="0"
                               Padding="4, 0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.SourceLabel}}" />
                        <TextBlock Grid.Row="1"
                                   Grid.Column="1"
                                   VerticalAlignment="Center"
                                   Text="{Binding Path=Source.Name}" />
                        <Label Grid.Row="2"
                               Grid.Column="0"
                               Padding="4, 0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.DurationLabel}}" />
                        <TextBlock Grid.Row="2"
                                   Grid.Column="1"
                                   VerticalAlignment="Center"
                                   Text="{Binding Path=DurationRounds}" />
                        <Label Grid.Row="3"
                               Grid.Column="0"
                               Padding="4, 0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.RemainingRoundsLabel}}" />
                        <TextBlock Grid.Row="3"
                                   Grid.Column="1"
                                   VerticalAlignment="Center"
                                   Text="{Binding Path=RemainingRounds}" />
                    </Grid>
                </ToolTip>
            </Grid.ToolTip>
        </Grid>
        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding Source}"
                         Value="{x:Null}">
                <Setter TargetName="SourceText"
                        Property="Visibility"
                        Value="Collapsed" />
            </DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>

    <Style TargetType="{x:Type controls:ServerConfigView}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ServerConfigView}">
                    <Grid>
                        <TextBlock Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.ServerUri, UpdateSourceTrigger=PropertyChanged}" />
                    </Grid>    
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:CombatantStatText}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:CombatantStatText}">
                    <ContentPresenter Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Parts}" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:GeneralCombatantView}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:GeneralCombatantView}">
                    <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                                  VerticalScrollBarVisibility="Auto"
                                  PanningMode="VerticalOnly">
                        <Grid x:Name="PART_RootGrid">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column="0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label Grid.Row="0"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                                <TextBox Grid.Row="0"
                                         Grid.Column="1"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.Name, UpdateSourceTrigger=PropertyChanged}" />
                                <CheckBox Grid.Row="1"
                                          Grid.Column="1"
                                          Content="{Binding Source={x:Static resources:Resources.DisplayToPlayersLabel}}"
                                          IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.DisplayToPlayers}" />
                                <Label Grid.Row="2"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.DisplayNameLabel}}" />
                                <TextBox Grid.Row="2"
                                         Grid.Column="1"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.DisplayName, UpdateSourceTrigger=PropertyChanged}" />
                                <Border Grid.Row="3"
                                        Grid.ColumnSpan="2"
                                        BorderThickness="0,0,0,2"
                                        BorderBrush="{StaticResource {x:Static controls:ResourceKeys.FadeToLeftBrush}}" />
                                <Label Grid.Row="4"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.MaxHitPointsLabel}}" />
                                <TextBox Grid.Row="4"
                                         Grid.Column="1"
                                         windows:TextBoxHelper.DataType="NonNegativeInteger"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.Health.MaxHealth, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="5"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.DamageLabel}}" />
                                <TextBox Grid.Row="5"
                                         Grid.Column="1"
                                         windows:TextBoxHelper.DataType="NonNegativeInteger"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.Health.LethalDamage, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="6"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.NonLethalDamageLabel}}" />
                                <TextBox Grid.Row="6"
                                         Grid.Column="1"
                                         windows:TextBoxHelper.DataType="NonNegativeInteger"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.Health.NonlethalDamage, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="7"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.TemporaryHitPointsLabel}}" />
                                <TextBox Grid.Row="7"
                                         Grid.Column="1"
                                         windows:TextBoxHelper.DataType="NonNegativeInteger"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.Health.TemporaryHitPoints, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="8"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.UnconsciousAtLabel}}" />
                                <TextBox Grid.Row="8"
                                         Grid.Column="1"
                                         windows:TextBoxHelper.DataType="Integer"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.Health.UnconsciousAt, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="9"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.DeadAtLabel}}" />
                                <TextBox Grid.Row="9"
                                         Grid.Column="1"
                                         windows:TextBoxHelper.DataType="Integer"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.Health.DeadAt, UpdateSourceTrigger=PropertyChanged}" />
                                <CheckBox Grid.Row="10"
                                          Grid.Column="1"
                                          Content="{Binding Source={x:Static resources:Resources.IncludeInCombatLabel}}"
                                          IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.IncludeInCombat}" />
                                <Label Grid.Row="11"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.DamageReductionLabel}}" />
                                <controls:DamageReductionLine Grid.Row="11"
                                                              Grid.Column="1"
                                                              DamageReduction="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.DamageReduction}" />
                            </Grid>
                            <controls:EffectsPanel Grid.Column="1"
                                                   Combat="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combat}"
                                                   Combatant="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant}" />
                        </Grid>
                    </ScrollViewer>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <DataTemplate x:Key="{x:Static controls:ResourceKeys.MonsterViewTemplate}">
        <Grid Margin="4"
              Grid.IsSharedSizeScope="True"
              DataContext="{Binding RelativeSource={RelativeSource AncestorType={x:Type ContentPresenter}}, Path=DataContext, Converter={StaticResource MonsterConverter}}">
            <Grid.Resources>
                <CollectionViewSource x:Key="StatCollection"
                                      Source="{Binding Stats}"
                                      Filter="{x:Static controls:ManageMonsters.MonsterViewerStatFilter}">
                    <CollectionViewSource.GroupDescriptions>
                        <PropertyGroupDescription PropertyName="Category" />
                    </CollectionViewSource.GroupDescriptions>
                </CollectionViewSource>
            </Grid.Resources>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <!--  Required Combat Statistics  -->
            <Grid Grid.Row="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition SharedSizeGroup="Labels" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Row="0"
                           Grid.Column="0"
                           Grid.ColumnSpan="2"
                           Text="{Binding Path=Name}"
                           FontSize="{StaticResource {x:Static controls:ResourceKeys.HeaderFontSize}}"
                           Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}" />
                <Label Grid.Row="1"
                       Grid.Column="0"
                       Padding="4, 0"
                       TextElement.Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static resources:Resources.HitDiceLabel}}" />
                <TextBlock Grid.Row="1"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=HitDice}" />
                <Label Grid.Row="2"
                       Grid.Column="0"
                       Padding="4, 0"
                       TextElement.Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static resources:Resources.InitiativeModifierLabel}}" />
                <TextBlock Grid.Row="2"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=InitiativeModifier}" />
                <Label Grid.Row="3"
                       Grid.Column="0"
                       Padding="4, 0"
                       TextElement.Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static resources:Resources.FastHealingLabel}}" />
                <TextBlock Grid.Row="3"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=FastHealing}" />
                <Label Grid.Row="4"
                       Grid.Column="0"
                       Padding="4, 0"
                       TextElement.Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static resources:Resources.SourceLabel}}" />
                <TextBlock Grid.Row="4"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=Source}" />
            </Grid>
            <!--  Optional Statistics  -->
            <ItemsControl Grid.Row="1"
                          ItemsSource="{Binding Source={StaticResource StatCollection}}">
                <ItemsControl.GroupStyle>
                    <GroupStyle>
                        <GroupStyle.HeaderTemplate>
                            <DataTemplate>
                                <Border BorderBrush="{StaticResource {x:Static controls:ResourceKeys.FadeToRightBrush}}"
                                        BorderThickness="0,0,0,2">
                                    <TextBlock Text="{Binding Path=Name}"
                                               FontSize="{StaticResource {x:Static controls:ResourceKeys.SubheaderFontSize}}"
                                               Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}" />
                                </Border>
                            </DataTemplate>
                        </GroupStyle.HeaderTemplate>
                    </GroupStyle>
                </ItemsControl.GroupStyle>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition SharedSizeGroup="Labels" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Label Grid.Column="0"
                                   Padding="4, 0"
                                   TextElement.Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Path=Name}" />
                            <controls:CombatantStatText Grid.Column="1"
                                                        Text="{Binding Path=Value, Converter={StaticResource StringJoinConverter}}" />
                        </Grid>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Grid>
    </DataTemplate>
    <DataTemplate x:Key="{x:Static controls:ResourceKeys.MonsterDefenseTemplate}">
        <Grid>
            <Grid.Resources>
                <CollectionViewSource x:Key="StatCollection"
                                      Source="{Binding Stats}"
                                      Filter="{x:Static controls:ManageMonsters.MonsterDefenseStatFilter}">
                    <CollectionViewSource.GroupDescriptions>
                        <PropertyGroupDescription PropertyName="Category" />
                    </CollectionViewSource.GroupDescriptions>
                </CollectionViewSource>
            </Grid.Resources>
            <ItemsControl Grid.Row="1"
                          ItemsSource="{Binding Source={StaticResource StatCollection}}">
                <ItemsControl.GroupStyle>
                    <GroupStyle>
                        <GroupStyle.HeaderTemplate>
                            <DataTemplate>
                                <Border BorderBrush="{StaticResource {x:Static controls:ResourceKeys.FadeToRightBrush}}"
                                        BorderThickness="0,0,0,2">
                                    <TextBlock Text="{Binding Path=Name}"
                                               FontSize="{StaticResource {x:Static controls:ResourceKeys.SubheaderFontSize}}"
                                               Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}" />
                                </Border>
                            </DataTemplate>
                        </GroupStyle.HeaderTemplate>
                    </GroupStyle>
                </ItemsControl.GroupStyle>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition SharedSizeGroup="Labels" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Label Grid.Column="0"
                                   Padding="4, 0"
                                   TextElement.Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Path=Name}" />
                            <controls:CombatantStatText Grid.Column="1"
                                                        Text="{Binding Path=Value, Converter={StaticResource StringJoinConverter}}" />
                        </Grid>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Grid>
    </DataTemplate>
    <DataTemplate x:Key="{x:Static controls:ResourceKeys.PlayerCharacterTemplate}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Label Grid.Row="0"
                   Grid.Column="0"
                   TextElement.Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
            <TextBlock Grid.Row="0"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Name}" />
            <Label Grid.Row="1"
                   Grid.Column="0"
                   VerticalAlignment="Center"
                   TextElement.Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.PlayerNameLabel}}" />
            <TextBlock Grid.Row="1"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Player}" />
            <Label Grid.Row="2"
                   Grid.Column="0"
                   VerticalAlignment="Center"
                   TextElement.Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.InitiativeModifierLabel}}" />
            <TextBlock Grid.Row="2"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding InitiativeModifier}" />
            <CheckBox Grid.Row="3"
                      Grid.Column="1"
                      VerticalAlignment="Center"
                      IsEnabled="False"
                      Content="{Binding Source={x:Static resources:Resources.IncludeInCombatLabel}}"
                      IsChecked="{Binding IncludeInCombat}" />
            <Label Grid.Row="4"
                   Grid.Column="0"
                   VerticalAlignment="Center"
                   TextElement.Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.LightRadiusLabel}}" />
            <TextBlock Grid.Row="4"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding LightRadius}" />
            <Label Grid.Row="5"
                   Grid.Column="0"
                   VerticalAlignment="Center"
                   TextElement.Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.SensesLabel}}" />
            <TextBlock Grid.Row="5"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Senses}" />
            <Label Grid.Row="6"
                   Grid.Column="0"
                   VerticalAlignment="Center"
                   TextElement.Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.LanguagesLabel}}" />
            <TextBlock Grid.Row="6"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Languages}" />
            <Label Grid.Row="7"
                   Grid.Column="0"
                   VerticalAlignment="Center"
                   TextElement.Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static vmresources:Resources.AlignmentLabel}}" />
            <TextBlock Grid.Row="7"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Alignment, Converter={StaticResource AlignmentConverter}}" />
            <!--  Notes should always be in last row  -->
            <Label Grid.Row="8"
                   Grid.Column="0"
                   VerticalAlignment="Top"
                   TextElement.Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.NotesLabel}}" />
            <ItemsControl Grid.Row="8"
                          Grid.Column="1"
                          ItemsSource="{Binding Notes}"
                          HorizontalContentAlignment="Stretch">
                <ItemsControl.ItemContainerStyle>
                    <Style TargetType="{x:Type ContentPresenter}">
                        <Setter Property="HorizontalAlignment"
                                Value="Stretch" />
                    </Style>
                </ItemsControl.ItemContainerStyle>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       FontFamily="Segoe UI Symbol"
                                       FontSize="8"
                                       VerticalAlignment="Center"
                                       Margin="4"
                                       Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                       Text="{Binding Source={x:Static resources:Resources.NoteMarker}}" />
                            <TextBlock Grid.Column="1"
                                       Text="{Binding}"
                                       TextWrapping="Wrap" />
                        </Grid>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Grid>
    </DataTemplate>
    <DataTemplate x:Key="{x:Static controls:ResourceKeys.SpellTemplate}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Border Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="2"
                    BorderThickness="0,0,0,2"
                    BorderBrush="{StaticResource {x:Static controls:ResourceKeys.FadeToRightBrush}}">
                <TextBlock Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                           FontSize="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontSize}}"
                           Text="{Binding Name}" />
            </Border>
            <TextBlock Grid.Row="1"
                       Grid.Column="0"
                       Grid.ColumnSpan="2"
                       Margin="20, 0"
                       FontSize="{DynamicResource {x:Static controls:ResourceKeys.SubheaderFontSize}}"
                       VerticalAlignment="Center"
                       Text="{Binding School}" />
            <TextBlock Grid.Row="2"
                       Grid.Column="0"
                       Grid.ColumnSpan="2"
                       VerticalAlignment="Center"
                       Text="{Binding ShortDescription}" />
            <Label Grid.Row="3"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.EffectTypesLabel}}" />
            <TextBlock Grid.Row="3"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding EffectTypes, Converter={StaticResource StringJoinConverter}}" />
            <Label Grid.Row="4"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.SubschoolLabel}}" />
            <TextBlock Grid.Row="4"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding SubSchool}" />
            <Label Grid.Row="5"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.LevelLabel}}" />
            <ItemsControl Grid.Row="5"
                          Grid.Column="1"
                          VerticalAlignment="Center"
                          ItemsSource="{Binding Levels}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel Orientation="Horizontal"
                                   IsItemsHost="True" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="{Binding Class}" />
                            <TextBlock Grid.Column="1"
                                       Margin="4, 0, 8, 0"
                                       Text="{Binding Level}" />
                        </Grid>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
            <Label Grid.Row="6"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.CastingTimeLabel}}" />
            <TextBlock Grid.Row="6"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding CastingTime}" />
            <Label Grid.Row="7"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.ComponentsLabel}}" />
            <TextBlock Grid.Row="7"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Components}" />
            <Label Grid.Row="8"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.CostlyComponentsLabel}}" />
            <TextBlock Grid.Row="8"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding CostlyComponents}" />
            <Label Grid.Row="9"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.RangeLabel}}" />
            <TextBlock Grid.Row="9"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Range}" />
            <Label Grid.Row="10"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.AreaLabel}}" />
            <TextBlock Grid.Row="10"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Area}" />
            <Label Grid.Row="11"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.EffectLabel}}" />
            <TextBlock Grid.Row="11"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Effect}" />
            <Label Grid.Row="12"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.TargetsLabel}}" />
            <TextBlock Grid.Row="12"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Targets}" />
            <Label Grid.Row="13"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.DurationLabel}}" />
            <TextBlock Grid.Row="13"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Duration}" />
            <Label Grid.Row="14"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.DismissibleLabel}}" />
            <CheckBox Grid.Row="14"
                      Grid.Column="1"
                      VerticalAlignment="Center"
                      IsEnabled="False"
                      IsChecked="{Binding Dismissible}" />
            <Label Grid.Row="15"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.ShapeableLabel}}" />
            <CheckBox Grid.Row="15"
                      Grid.Column="1"
                      VerticalAlignment="Center"
                      IsEnabled="False"
                      IsChecked="{Binding Shapeable}" />
            <Label Grid.Row="16"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.SpellResistanceLabel}}" />
            <TextBlock Grid.Row="16"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding SpellResistance}" />
            <Label Grid.Row="17"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.SourceLabel}}" />
            <TextBlock Grid.Row="17"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Source}" />
            <TextBlock Grid.Row="18"
                       Grid.Column="0"
                       Grid.ColumnSpan="2"
                       VerticalAlignment="Center"
                       TextWrapping="Wrap"
                       Text="{Binding Description}" />
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="{x:Static controls:ResourceKeys.EffectTemplate}">
        <Grid Margin="4">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid x:Name="StatBlock"
                  Grid.Row="0"
                  Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Row="0"
                           Grid.Column="0"
                           Grid.ColumnSpan="2"
                           FontSize="{StaticResource {x:Static controls:ResourceKeys.HeaderFontSize}}"
                           TextTrimming="CharacterEllipsis"
                           Text="{Binding Name}" />
                <Label Grid.Row="1"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Padding="0, 0, 4, 0"
                       Content="{Binding Source={x:Static resources:Resources.SourceLabel}}" />
                <TextBlock Grid.Row="1"
                           Grid.Column="1"
                           Text="{Binding Source.Name}" />
                <Label Grid.Row="2"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Padding="0, 0, 4, 0"
                       Content="{Binding Source={x:Static resources:Resources.InitiativeSourceLabel}}" />
                <TextBlock Grid.Row="2"
                           Grid.Column="1"
                           Text="{Binding InitiativeSource.Name}" />
                <Label Grid.Row="3"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Padding="0, 0, 4, 0"
                       Content="{Binding Source={x:Static resources:Resources.DurationLabel}}" />
                <TextBlock Grid.Row="3"
                           Grid.Column="1"
                           Text="{Binding DurationRounds}" />
                <Label Grid.Row="4"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Padding="0, 0, 4, 0"
                       Content="{Binding Source={x:Static resources:Resources.RemainingRoundsLabel}}" />
                <TextBlock Grid.Row="4"
                           Grid.Column="1"
                           Text="{Binding RemainingRounds}" />
            </Grid>
            <Grid Grid.Row="0"
                  Grid.Column="1"
                  Height="{Binding ElementName=StatBlock, Path=ActualHeight}">
                <Grid.Resources>
                    <CollectionViewSource x:Key="TargetsCollection"
                                          Source="{Binding Targets}">
                        <CollectionViewSource.SortDescriptions>
                            <comp:SortDescription PropertyName="Name"
                                                  Direction="Ascending" />
                        </CollectionViewSource.SortDescriptions>
                    </CollectionViewSource>
                </Grid.Resources>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Label Grid.Row="0"
                       HorizontalAlignment="Center"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static resources:Resources.TargetsLabel}}" />
                <ScrollViewer Grid.Row="1"
                              VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Disabled"
                              PanningMode="VerticalOnly">
                    <ItemsControl ItemsSource="{Binding Source={StaticResource TargetsCollection}}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <controls:CombatantNamePanel Combatant="{Binding}"
                                                             Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>
            <Grid Grid.Row="1"
                  Grid.ColumnSpan="2"
                  Margin="0, 4, 0, 0">
                <ContentPresenter Content="{Binding RelatedItem}"
                                  ContentTemplate="{DynamicResource {x:Static controls:ResourceKeys.ObjectViewTemplate}}" />
            </Grid>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="{x:Static controls:ResourceKeys.MagicItemTemplate}">
        <Grid Grid.IsSharedSizeScope="True">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="Labels" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Row="0"
                       Grid.ColumnSpan="2"
                       FontSize="{StaticResource {x:Static controls:ResourceKeys.HeaderFontSize}}"
                       Text="{Binding Path=Name}" />
            <Label Grid.Row="1"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static vmresources:Resources.GroupLabel}}" />
            <TextBlock Grid.Row="1"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Path=Group}" />
            <Label Grid.Row="2"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.SlotLabel}}" />
            <TextBlock Grid.Row="2"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Path=Slot}" />
            <Label Grid.Row="3"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.WeightLabel}}" />
            <TextBlock Grid.Row="3"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Path=Weight}" />
            <Label Grid.Row="4"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.PriceLabel}}" />
            <TextBlock Grid.Row="4"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Path=PriceInCopper, Converter={StaticResource MonetaryConverter}, ConverterParameter=gold}" />
            <Border Grid.Row="5"
                    BorderBrush="{DynamicResource {x:Static controls:ResourceKeys.FadeToRightBrush}}"
                    BorderThickness="0, 0, 0, 2" />
            <Label Grid.Row="6"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.CasterLevelLabel}}" />
            <TextBlock Grid.Row="6"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Path=CasterLevel}" />
            <Label Grid.Row="7"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.RequirementsLabel}}" />
            <TextBlock Grid.Row="7"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Path=Requirements}" />
            <Label Grid.Row="8"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.CostLabel}}" />
            <TextBlock Grid.Row="8"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Path=CostInCopper, Converter={StaticResource MonetaryConverter}, ConverterParameter=gold}" />
            <Label Grid.Row="9"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.AurasLabel}}" />
            <TextBlock Grid.Row="9"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Path=Auras, Converter={StaticResource StringJoinConverter}}" />
            <Label Grid.Row="10"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.AuraStrengthLabel}}" />
            <TextBlock Grid.Row="10"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Path=AuraStrength}" />
            <Grid Grid.Row="11"
                  Grid.ColumnSpan="2"
                  Visibility="{Binding Path=IsIntelligent, Converter={StaticResource BooleanToVisibility}}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition SharedSizeGroup="Labels" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Label Grid.Row="0"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static vmresources:Resources.AlignmentLabel}}" />
                <TextBlock Grid.Row="0"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=Alignment}" />
                <Label Grid.Row="1"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static vmresources:Resources.IntelligenceLabel}}" />
                <TextBlock Grid.Row="1"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=Intelligence}" />
                <Label Grid.Row="2"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static vmresources:Resources.WisdomLabel}}" />
                <TextBlock Grid.Row="2"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=Wisdom}" />
                <Label Grid.Row="3"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static vmresources:Resources.CharismaLabel}}" />
                <TextBlock Grid.Row="3"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=Charisma}" />
                <Label Grid.Row="4"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static resources:Resources.EgoLabel}}" />
                <TextBlock Grid.Row="4"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=Ego}" />
                <Label Grid.Row="5"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static resources:Resources.CommunicationLabel}}" />
                <TextBlock Grid.Row="5"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=Communications}" />
                <Label Grid.Row="6"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static vmresources:Resources.SensesLabel}}" />
                <TextBlock Grid.Row="6"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=Senses}" />
                <Label Grid.Row="7"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static resources:Resources.PowersLabel}}" />
                <TextBlock Grid.Row="7"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=Powers}" />
                <Label Grid.Row="8"
                       Grid.Column="0"
                       Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Content="{Binding Source={x:Static vmresources:Resources.LanguagesLabel}}" />
                <TextBlock Grid.Row="8"
                           Grid.Column="1"
                           VerticalAlignment="Center"
                           Text="{Binding Path=Languages}" />
            </Grid>
            <Label Grid.Row="12"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.ArtifactLevelLabel}}" />
            <TextBlock Grid.Row="12"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Path=ArtifactLevel}" />
            <Label Grid.Row="13"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.MythicLabel}}" />
            <CheckBox Grid.Row="13"
                      Grid.Column="1"
                      IsChecked="{Binding Path=Mythic}"
                      IsEnabled="False" />
            <Label Grid.Row="14"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static resources:Resources.SourceLabel}}" />
            <TextBlock Grid.Row="14"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       Text="{Binding Path=Source}" />
            <Label Grid.Row="15"
                   Grid.Column="0"
                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                   Content="{Binding Source={x:Static vmresources:Resources.DescriptionLabel}}" />
            <TextBlock Grid.Row="15"
                       Grid.Column="1"
                       VerticalAlignment="Center"
                       TextWrapping="Wrap"
                       Text="{Binding Path=Description}" />
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="{x:Static controls:ResourceKeys.StaticObjectViewTemplate}">
        <ContentPresenter>
            <ContentPresenter.ContentTemplateSelector>
                <windows:XamlTemplateSelector>
                    <windows:XamlTemplateSelector.Templates>
                        <windows:XamlTemplate Type="{x:Type monsters:Monster}"
                                              Template="{StaticResource {x:Static controls:ResourceKeys.MonsterViewTemplate}}" />
                        <windows:XamlTemplate Type="{x:Type players:PlayerCharacter}"
                                              Template="{StaticResource {x:Static controls:ResourceKeys.PlayerCharacterTemplate}}" />
                        <windows:XamlTemplate Type="{x:Type spells:Spell}"
                                              Template="{StaticResource {x:Static controls:ResourceKeys.SpellTemplate}}" />
                        <windows:XamlTemplate Type="{x:Type combat:Effect}"
                                              Template="{StaticResource {x:Static controls:ResourceKeys.EffectTemplate}}" />
                        <windows:XamlTemplate Type="{x:Type equipment:MagicItem}"
                                              Template="{StaticResource {x:Static controls:ResourceKeys.MagicItemTemplate}}" />
                    </windows:XamlTemplateSelector.Templates>
                </windows:XamlTemplateSelector>
            </ContentPresenter.ContentTemplateSelector>
        </ContentPresenter>
    </DataTemplate>

    <DataTemplate x:Key="{x:Static controls:ResourceKeys.ObjectViewTemplate}">
        <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                      VerticalScrollBarVisibility="Auto"
                      PanningMode="VerticalOnly">
            <ContentPresenter ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.StaticObjectViewTemplate}}" />
        </ScrollViewer>
    </DataTemplate>

    <DataTemplate x:Key="{x:Static controls:ResourceKeys.GroupHeaderTemplate}">
        <Border BorderBrush="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                BorderThickness="0, 0, 0, 2">
            <TextBlock Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                       Text="{Binding Name}" />
        </Border>
    </DataTemplate>

    <!--  ContextMenu used for Combatants  -->
    <ContextMenu x:Key="CombatantMenu">
        <ContextMenu.Resources>
            <CollectionViewSource x:Key="ConditionsCollection"
                                  Source="{Binding Campaign.Conditions.Conditions}">
                <CollectionViewSource.SortDescriptions>
                    <comp:SortDescription PropertyName="Name"
                                          Direction="Ascending" />
                </CollectionViewSource.SortDescriptions>
            </CollectionViewSource>
        </ContextMenu.Resources>
        <MenuItem Header="{Binding Source={x:Static resources:Resources.MoveBeforeCurrentMenuHeader}}"
                  Command="local:Commands.MoveBefore"
                  CommandParameter="{Binding}" />
        <MenuItem Header="{Binding Source={x:Static resources:Resources.MoveAfterCurrentMenuHeader}}"
                  Command="local:Commands.MoveAfter"
                  CommandParameter="{Binding}" />
        <MenuItem Header="{Binding Source={x:Static resources:Resources.KillCombatantMenuHeader}}"
                  Command="local:Commands.KillCombatant"
                  CommandParameter="{Binding}" />
        <Separator />
        <MenuItem Header="{Binding Source={x:Static resources:Resources.NewEffectMenuItem}}"
                  Command="local:Commands.CreateEffect"
                  CommandParameter="{Binding}" />
        <MenuItem Header="{Binding Source={x:Static resources:Resources.AddConditionMenuHeader}}"
                  ItemsSource="{Binding Source={StaticResource ConditionsCollection}}"
                  DisplayMemberPath="Name">
            <MenuItem.ItemContainerStyle>
                <Style TargetType="{x:Type MenuItem}">
                    <Setter Property="Command"
                            Value="local:Commands.AddCondition" />
                    <Setter Property="CommandParameter"
                            Value="{Binding}" />
                </Style>
            </MenuItem.ItemContainerStyle>
        </MenuItem>
    </ContextMenu>

    <!--  Main Tab View for Application  -->
    <Style TargetType="{x:Type local:MainTabControl}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:MainTabControl}">
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="CollectionSource"
                                                  Source="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:MainTabControl}}, Path=ItemsSource}"
                                                  IsLiveGroupingRequested="True">
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="ViewModelCategory" />
                                </CollectionViewSource.GroupDescriptions>
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="ViewModelCategory" />
                                    <comp:SortDescription PropertyName="ViewModelDisplayName" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <!--  Tabs  -->
                            <RowDefinition Height="Auto" />
                            <!--  Content  -->
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <ListBox x:Name="PART_ListBox"
                                 Background="{TemplateBinding Background}"
                                 Grid.Row="0"
                                 Grid.IsSharedSizeScope="True"
                                 ItemsSource="{Binding Source={StaticResource CollectionSource}}"
                                 SelectedValue="{TemplateBinding SelectedValue}"
                                 SelectedValuePath="{TemplateBinding SelectedValuePath}"
                                 DisplayMemberPath="{TemplateBinding DisplayMemberPath}"
                                 ItemTemplate="{TemplateBinding ItemTemplate}"
                                 ItemTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                 BorderThickness="0"
                                 BorderBrush="Transparent"
                                 Focusable="False">
                            <ListBox.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal"
                                               IsItemsHost="True" />
                                </ItemsPanelTemplate>
                            </ListBox.ItemsPanel>
                            <ListBox.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.Panel>
                                        <ItemsPanelTemplate>
                                            <VirtualizingStackPanel Orientation="Vertical"
                                                                    IsItemsHost="True" />
                                        </ItemsPanelTemplate>
                                    </GroupStyle.Panel>
                                    <GroupStyle.ContainerStyle>
                                        <Style TargetType="{x:Type GroupItem}">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="{x:Type GroupItem}">
                                                        <StackPanel Orientation="Horizontal">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition SharedSizeGroup="Headers" />
                                                                </Grid.ColumnDefinitions>
                                                                <TextBlock Text="{Binding Name}"
                                                                           Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                                                           VerticalAlignment="Center"
                                                                           HorizontalAlignment="Right"
                                                                           Margin="0, 0, 4, 0" />
                                                            </Grid>
                                                            <ItemsPresenter />
                                                        </StackPanel>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </GroupStyle.ContainerStyle>
                                </GroupStyle>
                            </ListBox.GroupStyle>
                        </ListBox>
                        <ContentPresenter x:Name="PART_Content"
                                          Grid.Row="1"
                                          Content="{Binding ElementName=PART_ListBox, Path=SelectedValue}"
                                          ContentTemplate="{TemplateBinding ContentTemplate}"
                                          ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  Campaign Controls  -->

    <!--  Preparing for Combat  -->
    <DataTemplate x:Key="{x:Static controls:ResourceKeys.CombatantPreparerTemplate}">
        <ScrollViewer Grid.Row="1"
                      HorizontalScrollBarVisibility="Disabled"
                      VerticalScrollBarVisibility="Auto"
                      PanningMode="VerticalOnly">
            <Grid x:Name="PART_InputPanel">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Label Grid.Row="0"
                       Grid.Column="0"
                       Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                <TextBox Grid.Row="0"
                         Grid.Column="1"
                         Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"
                         MaxLength="50" />
                <CheckBox Grid.Row="1"
                          Grid.Column="1"
                          Content="{Binding Source={x:Static resources:Resources.DisplayToPlayersLabel}}"
                          IsChecked="{Binding DisplayToPlayers}" />
                <Label Grid.Row="2"
                       Grid.Column="0"
                       Content="{Binding Source={x:Static resources:Resources.DisplayNameLabel}}" />
                <TextBox Grid.Row="2"
                         Grid.Column="1"
                         Text="{Binding DisplayName, UpdateSourceTrigger=PropertyChanged}"
                         MaxLength="50" />
                <Border Grid.Row="3"
                        Grid.ColumnSpan="2"
                        BorderThickness="0,0,0,2"
                        BorderBrush="{StaticResource {x:Static controls:ResourceKeys.FadeToRightBrush}}" />
                <Label Grid.Row="4"
                       Grid.Column="0"
                       Content="{Binding Source={x:Static resources:Resources.HitDiceLabel}}" />
                <TextBox Grid.Row="4"
                         Grid.Column="1"
                         Text="{Binding HitDieString, UpdateSourceTrigger=PropertyChanged}"
                         MaxLength="50" />
                <Label Grid.Row="5"
                       Grid.Column="0"
                       Content="{Binding Source={x:Static resources:Resources.RollingStrategyLabel}}" />
                <ComboBox Grid.Row="5"
                          Grid.Column="1"
                          ItemsSource="{Binding Source={x:Static controls:RollingStrategyExtensions.ItemsSource}}"
                          SelectedValue="{Binding HitDiceStrategy}"
                          SelectedValuePath="Value"
                          DisplayMemberPath="Display" />
                <Label Grid.Row="6"
                       Grid.Column="0"
                       Content="{Binding Source={x:Static resources:Resources.MaxHitPointsLabel}}" />
                <Grid Grid.Row="6"
                      Grid.Column="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBox windows:TextBoxHelper.DataType="Integer"
                             Text="{Binding HitPoints, UpdateSourceTrigger=PropertyChanged}"
                             MaxLength="10" />
                    <Button Grid.Column="1"
                            VerticalAlignment="Center"
                            Command="local:Commands.Roll"
                            Content="{Binding Source={x:Static resources:Resources.RollLabel}}" />
                </Grid>
                <Label Grid.Row="7"
                       Grid.Column="0"
                       Content="{Binding Source={x:Static resources:Resources.FastHealingLabel}}" />
                <TextBox Grid.Row="7"
                         Grid.Column="1"
                         windows:TextBoxHelper.DataType="Integer"
                         Text="{Binding FastHealing, UpdateSourceTrigger=PropertyChanged}"
                         MaxLength="10" />
                <Label Grid.Row="8"
                       Grid.Column="0"
                       Content="{Binding Source={x:Static resources:Resources.UnconsciousAtLabel}}" />
                <TextBox Grid.Row="8"
                         Grid.Column="1"
                         windows:TextBoxHelper.DataType="Integer"
                         Text="{Binding UnconsciousAt, UpdateSourceTrigger=PropertyChanged}"
                         MaxLength="10" />
                <Label Grid.Row="9"
                       Grid.Column="0"
                       Content="{Binding Source={x:Static resources:Resources.DeadAtLabel}}" />
                <TextBox Grid.Row="9"
                         Grid.Column="1"
                         windows:TextBoxHelper.DataType="Integer"
                         Text="{Binding DeadAt, UpdateSourceTrigger=PropertyChanged}"
                         MaxLength="10" />
                <Border Grid.Row="10"
                        Grid.ColumnSpan="2"
                        BorderThickness="0,0,0,2"
                        BorderBrush="{StaticResource {x:Static controls:ResourceKeys.FadeToRightBrush}}" />
                <Label Grid.Row="11"
                       Grid.Column="0"
                       Content="{Binding Source={x:Static resources:Resources.InitiativeRollLabel}}" />
                <TextBox Grid.Row="11"
                         Grid.Column="1"
                         windows:TextBoxHelper.DataType="Integer"
                         Text="{Binding InitiativeRoll, UpdateSourceTrigger=PropertyChanged}"
                         MaxLength="10" />
                <Label Grid.Row="12"
                       Grid.Column="0"
                       Content="{Binding Source={x:Static resources:Resources.InitiativeModifierLabel}}" />
                <TextBox Grid.Row="12"
                         Grid.Column="1"
                         windows:TextBoxHelper.DataType="Integer"
                         Text="{Binding InitiativeModifier, UpdateSourceTrigger=PropertyChanged}"
                         MaxLength="10" />
                <Label Grid.Row="13"
                       Grid.Column="0"
                       Content="{Binding Source={x:Static resources:Resources.InitiativeTotalLabel}}" />
                <TextBox Grid.Row="13"
                         Grid.Column="1"
                         windows:TextBoxHelper.DataType="Integer"
                         x:Name="PART_InitiativeTotal"
                         Text="{Binding InitiativeTotal, UpdateSourceTrigger=PropertyChanged}"
                         MaxLength="10" />
                <ContentPresenter Grid.Row="14"
                                  Grid.ColumnSpan="2"
                                  Content="{Binding Path=Source.Source}"
                                  ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.StaticObjectViewTemplate}}" />
            </Grid>
        </ScrollViewer>
    </DataTemplate>

    <!--  Combat Scenario Management  -->
    <Style TargetType="{x:Type controls:CombatScenarios}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:CombatScenarios}">
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="ScenariosCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Scenarios}"
                                                  IsLiveGroupingRequested="True"
                                                  IsLiveSortingRequested="True">
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="Group" />
                                </CollectionViewSource.GroupDescriptions>
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Group"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.LiveGroupingProperties>
                                    <sys:String>Group</sys:String>
                                </CollectionViewSource.LiveGroupingProperties>
                                <CollectionViewSource.LiveSortingProperties>
                                    <sys:String>Group</sys:String>
                                    <sys:String>Name</sys:String>
                                </CollectionViewSource.LiveSortingProperties>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="4*" />
                        </Grid.ColumnDefinitions>
                        <ListBox x:Name="PART_ScenarioList"
                                 ItemsSource="{Binding Source={StaticResource ScenariosCollection}}"
                                 SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedScenario}">
                            <ListBox.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.ContainerStyle>
                                        <Style TargetType="{x:Type GroupItem}">
                                            <Setter Property="HorizontalContentAlignment"
                                                    Value="Stretch" />
                                        </Style>
                                    </GroupStyle.ContainerStyle>
                                    <GroupStyle.HeaderTemplate>
                                        <DataTemplate>
                                            <Border Margin="4,0"
                                                    BorderBrush="{DynamicResource {x:Static controls:ResourceKeys.FadeToRightBrush}}"
                                                    BorderThickness="0, 0, 0, 2">
                                                <TextBlock Text="{Binding Name}"
                                                           Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}" />
                                            </Border>
                                        </DataTemplate>
                                    </GroupStyle.HeaderTemplate>
                                </GroupStyle>
                            </ListBox.GroupStyle>
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Path=Name}" />
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                        <Grid Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <controls:AddRemoveEdit AllowEdit="True" />
                            <controls:CombatScenarioView Grid.Row="1"
                                                         Margin="4, 0, 0, 0"
                                                         Scenario="{Binding ElementName=PART_ScenarioList, Path=SelectedValue}"
                                                         Visibility="{Binding ElementName=PART_ScenarioList, Path=SelectedValue, Converter={StaticResource ReferenceToVisibility}}" />
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  Consistent display of a monster name  -->
    <DataTemplate x:Key="{x:Static controls:ResourceKeys.MonsterNameTemplate}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Text="{Binding Name}"
                       TextTrimming="CharacterEllipsis" />
            <TextBlock Grid.Column="1"
                       x:Name="GroupText">
                                                <Run Text="(" />
                                                <Run Text="{Binding Stats[group].Value}" />
                                                <Run Text=")" />
            </TextBlock>
        </Grid>
        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding Stats[group].Value}"
                         Value="">
                <Setter Property="Visibility"
                        Value="Collapsed"
                        TargetName="GroupText" />
            </DataTrigger>
            <DataTrigger Binding="{Binding Stats[group].Value}"
                         Value="{x:Null}">
                <Setter Property="Visibility"
                        Value="Collapsed"
                        TargetName="GroupText" />
            </DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>

    <!--  Consistent display of spell name  -->
    <DataTemplate x:Key="{x:Static controls:ResourceKeys.SpellNameTemplate}">
        <Grid Background="Transparent"
              ToolTip="{Binding ShortDescription}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Text="{Binding Name}"
                       TextTrimming="WordEllipsis" />
            <TextBlock Grid.Column="1">
                                                <Run Text="(" /> <Run Text="{Binding School, Mode=OneWay}" /> <Run Text=")" />
            </TextBlock>
            <TextBlock Grid.Row="1"
                       Grid.ColumnSpan="2"
                       Text="{Binding ShortDescription}"
                       TextTrimming="WordEllipsis" />
        </Grid>
    </DataTemplate>

    <!--  Consistent display of magic item name  -->
    <DataTemplate x:Key="{x:Static controls:ResourceKeys.MagicItemNameTemplate}">
        <Grid Background="Transparent">
            <TextBlock Text="{Binding Name}"
                       TextTrimming="CharacterEllipsis" />
        </Grid>
    </DataTemplate>

    <!--  Consistent display of combatant's name to GM  -->
    <Style TargetType="{x:Type controls:CombatantNamePanel}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Foreground"
                Value="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:CombatantNamePanel}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <!--  Name  -->
                        <TextBlock Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.Name}"
                                   Margin="0,0,4,0"
                                   Foreground="{TemplateBinding Foreground}"
                                   TextTrimming="CharacterEllipsis" />
                        <!--  Ordinal  -->
                        <TextBlock Grid.Column="1"
                                   Text="{Binding Path=Ordinal, FallbackValue=0, TargetNullValue=0}">
                            <TextBlock.Style>
                                <Style TargetType="{x:Type TextBlock}">
                                    <Setter Property="Visibility"
                                            Value="Visible" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Path=Ordinal, FallbackValue=0, TargetNullValue=0}"
                                                     Value="0">
                                            <Setter Property="Visibility"
                                                    Value="Collapsed" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                        <!--  Display Name  -->
                        <Grid Grid.Column="2"
                              Margin="4,0,0,0"
                              HorizontalAlignment="Right"
                              x:Name="DisplayNameText">
                            <Grid.Style>
                                <Style TargetType="{x:Type Grid}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.DisplayName}"
                                                     Value="">
                                            <Setter Property="Visibility"
                                                    Value="Collapsed" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.DisplayName}"
                                                     Value="{x:Null}">
                                            <Setter Property="Visibility"
                                                    Value="Collapsed" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Grid.Style>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="(" />
                            <TextBlock Grid.Column="1"
                                       TextTrimming="CharacterEllipsis"
                                       TextAlignment="Right"
                                       FontSize="{StaticResource {x:Static controls:ResourceKeys.TextFontSize}}"
                                       Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.DisplayName}" />
                            <TextBlock Grid.Column="2"
                                       Text=")" />
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  Read-only view of a combat scenario  -->
    <Style TargetType="{x:Type controls:CombatScenarioView}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:CombatScenarioView}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="3*" />
                        </Grid.RowDefinitions>
                        <Border BorderThickness="0,0,0,1"
                                BorderBrush="Black">
                            <TextBlock Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Scenario.Name}"
                                       FontSize="{StaticResource {x:Static controls:ResourceKeys.HeaderFontSize}}" />
                        </Border>
                        <TextBlock Grid.Row="1"
                                   Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Scenario.Group}"
                                   FontSize="{StaticResource {x:Static controls:ResourceKeys.SubheaderFontSize}}" />
                        <Grid Grid.Row="2"
                              Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <TextBlock Text="{Binding Source={x:Static resources:Resources.EncounterMembersLabel}}"
                                       Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                       FontSize="{StaticResource {x:Static controls:ResourceKeys.SubheaderFontSize}}" />
                            <ListBox x:Name="PART_CombatantList"
                                     Grid.Row="1"
                                     ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Scenario.Combatants}"
                                     SelectedItem="0"
                                     ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                                     ScrollViewer.PanningMode="VerticalOnly">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding Count}" />
                                                <TextBlock Text=" " />
                                                <controls:CombatantNamePanel Combatant="{Binding}" />
                                            </StackPanel>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Grid>
                        <TextBlock Grid.Row="3"
                                   TextWrapping="Wrap"
                                   Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Scenario.Details}" />
                        <Grid Grid.Row="4"
                              Margin="10, 0">
                            <ContentControl Content="{Binding ElementName=PART_CombatantList, Path=SelectedValue.Source}"
                                            ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.ObjectViewTemplate}}" />
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!--  Editor for a Combat Scenario  -->
    <Style TargetType="{x:Type controls:CombatScenarioEditor}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:CombatScenarioEditor}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Label Grid.Row="0"
                               Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                        <Label Grid.Row="1"
                               Content="{Binding Source={x:Static vmresources:Resources.GroupLabel}}" />
                        <Label Grid.Row="2"
                               Content="{Binding Source={x:Static resources:Resources.DetailsHeader}}" />
                        <TextBox Grid.Row="0"
                                 Grid.Column="1"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Scenario.Name, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBox Grid.Row="1"
                                 Grid.Column="1"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Scenario.Group, UpdateSourceTrigger=PropertyChanged}" />
                        <TextBox Grid.Row="2"
                                 Grid.Column="1"
                                 AcceptsReturn="True"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Scenario.Details, UpdateSourceTrigger=PropertyChanged}" />
                        <Label Grid.Row="3"
                               Grid.ColumnSpan="2"
                               Content="{Binding Source={x:Static resources:Resources.CombatantsLabel}}" />
                        <Grid Grid.Row="4"
                              Grid.ColumnSpan="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="4*" />
                            </Grid.ColumnDefinitions>
                            <Grid Grid.Column="0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <ListBox x:Name="PART_Combatants"
                                         ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Scenario.Combatants}"
                                         SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}"
                                         SelectedIndex="0"
                                         DisplayMemberPath="Name" />
                                <controls:AddRemoveEdit Grid.Row="1"
                                                        AllowEdit="False" />
                            </Grid>
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <ScrollViewer Grid.Row="0"
                                              HorizontalScrollBarVisibility="Disabled"
                                              VerticalScrollBarVisibility="Auto"
                                              PanningMode="VerticalOnly">
                                    <Grid IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent},Path=SelectedCombatant, Converter={StaticResource ReferenceToBoolean}}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <Label Grid.Row="0"
                                               Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                                        <Label Grid.Row="1"
                                               Content="{Binding Source={x:Static resources:Resources.HitDiceLabel}}" />
                                        <Label Grid.Row="2"
                                               Content="{Binding Source={x:Static resources:Resources.RollingStrategyLabel}}" />
                                        <Label Grid.Row="3"
                                               Content="{Binding Source={x:Static resources:Resources.InitiativeModifierLabel}}" />
                                        <Label Grid.Row="4"
                                               Content="{Binding Source={x:Static resources:Resources.CountLabel}}" />
                                        <Label Grid.Row="5"
                                               Content="{Binding Source={x:Static resources:Resources.FastHealingLabel}}" />
                                        <Label Grid.Row="6"
                                               Content="{Binding Source={x:Static resources:Resources.DeadAtLabel}}" />
                                        <Label Grid.Row="7"
                                               Content="{Binding Source={x:Static resources:Resources.UnconsciousAtLabel}}" />
                                        <Label Grid.Row="9"
                                               Content="{Binding Source={x:Static resources:Resources.DisplayNameLabel}}" />
                                        <Label Grid.Row="10"
                                               Grid.Column="0"
                                               Content="{Binding Source={x:Static resources:Resources.DamageReductionLabel}}" />
                                        <TextBox Grid.Row="0"
                                                 Grid.Column="1"
                                                 Text="{Binding ElementName=PART_Combatants, Path=SelectedValue.Name, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox Grid.Row="1"
                                                 Grid.Column="1"
                                                 Text="{Binding ElementName=PART_Combatants, Path=SelectedValue.HitDieString, UpdateSourceTrigger=PropertyChanged}" />
                                        <ComboBox Grid.Row="2"
                                                  Grid.Column="1"
                                                  ItemsSource="{Binding Source={x:Static controls:RollingStrategyExtensions.ItemsSource}}"
                                                  SelectedValue="{Binding ElementName=PART_Combatants, Path=SelectedValue.HitDieRollingStrategy}"
                                                  SelectedValuePath="Value"
                                                  DisplayMemberPath="Display" />
                                        <TextBox Grid.Row="3"
                                                 Grid.Column="1"
                                                 Text="{Binding ElementName=PART_Combatants, Path=SelectedValue.InitiativeModifier, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox Grid.Row="4"
                                                 Grid.Column="1"
                                                 x:Name="PART_CountTextBox"
                                                 Text="{Binding ElementName=PART_Combatants, Path=SelectedValue.Count, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox Grid.Row="5"
                                                 Grid.Column="1"
                                                 Text="{Binding ElementName=PART_Combatants, Path=SelectedValue.FastHealing, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox Grid.Row="6"
                                                 Grid.Column="1"
                                                 Text="{Binding ElementName=PART_Combatants, Path=SelectedValue.DeadAt, UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBox Grid.Row="7"
                                                 Grid.Column="1"
                                                 Text="{Binding ElementName=PART_Combatants, Path=SelectedValue.UnconsciousAt, UpdateSourceTrigger=PropertyChanged}" />
                                        <CheckBox Grid.Row="8"
                                                  Grid.Column="1"
                                                  Content="{Binding Source={x:Static resources:Resources.DisplayToPlayersLabel}}"
                                                  IsChecked="{Binding ElementName=PART_Combatants, Path=SelectedValue.DisplayToPlayers}" />
                                        <TextBox Grid.Row="9"
                                                 Grid.Column="1"
                                                 Text="{Binding ElementName=PART_Combatants, Path=SelectedValue.DisplayName, UpdateSourceTrigger=PropertyChanged}" />
                                        <controls:DamageReductionLine Grid.Row="10"
                                                                      Grid.Column="1"
                                                                      DamageReduction="{Binding ElementName=PART_Combatants, Path=SelectedValue.DamageReduction}" />
                                        <Button Grid.Row="11"
                                                Grid.Column="1"
                                                HorizontalAlignment="Right"
                                                Content="{Binding Source={x:Static resources:Resources.SourceButton}}"
                                                Command="local:Commands.ChooseSource"
                                                CommandParameter="{Binding ElementName=PART_Combatants, Path=SelectedValue}" />
                                    </Grid>
                                </ScrollViewer>
                                <ContentPresenter Grid.Row="1"
                                                  Margin="0,4,0,0"
                                                  Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant.Source}"
                                                  ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.ObjectViewTemplate}}" />
                                <GridSplitter Grid.Row="1"
                                              Style="{StaticResource {x:Static controls:ResourceKeys.VerticalSplitterStyle}}" />
                            </Grid>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  Combat Preparer Screen  -->
    <Style TargetType="{x:Type controls:PrepareCombat}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:PrepareCombat}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="4*" />
                        </Grid.ColumnDefinitions>
                        <!--  Left Column  -->
                        <Grid Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <!--  Combatant List  -->
                            <ListBox x:Name="PART_CombatantList"
                                     SelectedIndex="0"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                     ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Preparer.Combatants}"
                                     SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <controls:CombatantNamePanel Combatant="{Binding}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <!--  Add/Remove Combatants  -->
                            <controls:AddRemoveEdit Grid.Row="1"
                                                    AllowEdit="False" />
                        </Grid>
                        <!--  Right Column-->
                        <Grid Grid.Column="1"
                              x:Name="PART_InformationPanel"
                              Margin="4,0,0,0"
                              IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant, Converter={StaticResource ReferenceToBoolean}}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <!--  Options Panel  -->
                            <StackPanel Orientation="Horizontal"
                                        HorizontalAlignment="Right"
                                        Grid.Row="0">
                                <Button x:Name="PART_ClearPreparer"
                                        Content="{Binding Source={x:Static resources:Resources.ResetViewButton}}"
                                        Margin="4"
                                        Command="local:Commands.Reset"
                                        CommandParameter="{TemplateBinding Preparer}" />
                                <Button x:Name="PART_BeginCombat"
                                        Content="{Binding Source={x:Static resources:Resources.BeginCombatButton}}"
                                        Margin="4"
                                        Command="local:Commands.BeginCombat"
                                        CommandParameter="{TemplateBinding Preparer}" />
                            </StackPanel>
                            <!--  Combatant Information  -->
                            <ContentPresenter Grid.Row="1"
                                              Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}"
                                              ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.CombatantPreparerTemplate}}" />
                        </Grid>
                        <GridSplitter Grid.Column="1"
                                      Style="{StaticResource {x:Static controls:ResourceKeys.HorizontalSplitterStyle}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:SelectCombatScenario}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:SelectCombatScenario}">
                    <Grid x:Name="RootGrid">
                        <Grid.Resources>
                            <CollectionViewSource x:Key="ScenariosCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Scenarios.Scenarios}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Group"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="Group" />
                                </CollectionViewSource.GroupDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="2*" />
                        </Grid.ColumnDefinitions>
                        <!--  List of Scenarios  -->
                        <ListBox Grid.Column="0"
                                 x:Name="PART_ScenarioList"
                                 ItemsSource="{Binding Source={StaticResource ScenariosCollection}}"
                                 SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedScenario}">
                            <ListBox.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.ContainerStyle>
                                        <Style TargetType="{x:Type GroupItem}">
                                            <Setter Property="HorizontalContentAlignment"
                                                    Value="Stretch" />
                                        </Style>
                                    </GroupStyle.ContainerStyle>
                                    <GroupStyle.HeaderTemplate>
                                        <DataTemplate>
                                            <Border Margin="4, 0"
                                                    BorderBrush="{DynamicResource {x:Static controls:ResourceKeys.FadeToRightBrush}}"
                                                    BorderThickness="0, 0, 0, 4">
                                                <TextBlock Text="{Binding Name}" />
                                            </Border>
                                        </DataTemplate>
                                    </GroupStyle.HeaderTemplate>
                                </GroupStyle>
                            </ListBox.GroupStyle>
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Path=Name}" />
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                        <!--  Scenario Information  -->
                        <controls:CombatScenarioView Grid.Column="1"
                                                     Margin="4, 0, 0, 0"
                                                     Scenario="{Binding ElementName=PART_ScenarioList, Path=SelectedValue}"
                                                     Visibility="{Binding ElementName=PART_ScenarioList, Path=SelectedValue, Converter={StaticResource ReferenceToVisibility}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  Control for selecting a combatant source for adding to combat  -->
    <Style TargetType="{x:Type controls:SelectCombatantSource}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:SelectCombatantSource}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <!--  Combobox to Select Source Type  -->
                        <Grid Grid.Row="0">
                            <ComboBox x:Name="PART_SourceType"
                                      SelectedValuePath="DataContext"
                                      SelectedIndex="0">
                                <ComboBoxItem DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Factory.CombatScenarios}">
                                    <TextBlock Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Factory.CombatScenarios.ViewModelDisplayName}" />
                                </ComboBoxItem>
                            </ComboBox>
                        </Grid>
                        <!--  Sources and Descriptions  -->
                        <ContentPresenter Grid.Row="1"
                                          Margin="4"
                                          Content="{Binding ElementName=PART_SourceType, Path=SelectedItem.DataContext}">
                            <ContentPresenter.Resources>
                                <DataTemplate DataType="{x:Type vm:CombatScenariosViewModel}">
                                    <controls:SelectCombatScenario Scenarios="{Binding}"
                                                                   SelectedScenario="{Binding RelativeSource={RelativeSource AncestorType={x:Type controls:SelectCombatantSource}}, Path=ViewModel.SelectedSource}" />
                                </DataTemplate>
                            </ContentPresenter.Resources>
                        </ContentPresenter>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  Control for the currently active combat  -->
    <Style TargetType="{x:Type controls:ActiveCombat}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ActiveCombat}">
                    <Grid IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IsIdle}">
                        <Grid.InputBindings>
                            <KeyBinding Key="N"
                                        Modifiers="Ctrl"
                                        Command="local:Commands.NextCombatant" />
                        </Grid.InputBindings>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="4*" />
                        </Grid.ColumnDefinitions>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="CombatantsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combat.Combatants}"
                                                  IsLiveSortingRequested="True"
                                                  IsLiveFilteringRequested="True"
                                                  Filter="{x:Static controls:ActiveCombat.FilterOutInactiveCombatants}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="InitiativeOrder"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.LiveSortingProperties>
                                    <sys:String>InitiativeOrder</sys:String>
                                </CollectionViewSource.LiveSortingProperties>
                                <CollectionViewSource.LiveFilteringProperties>
                                    <sys:String>IncludeInCombat</sys:String>
                                </CollectionViewSource.LiveFilteringProperties>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <!--  Combatant List Column  -->
                        <Grid Grid.Column="0">
                            <ListBox x:Name="PART_CombatantList"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                     controls:CombatantDragDrop.Combatants="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combat.Combat}"
                                     ItemsSource="{Binding Source={StaticResource CombatantsCollection}}"
                                     SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}">
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="{x:Type ListBoxItem}"
                                           BasedOn="{StaticResource {x:Static controls:ResourceKeys.ListBoxItemStyle}}">
                                        <Setter Property="ContextMenu"
                                                Value="{StaticResource CombatantMenu}" />
                                    </Style>
                                </ListBox.ItemContainerStyle>
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid IsHitTestVisible="False">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock x:Name="CurrentMarker"
                                                       Grid.RowSpan="2"
                                                       Text="{Binding Source={x:Static resources:Resources.CurrentCombatantMarker}}"
                                                       Margin="0,0,4,0"
                                                       VerticalAlignment="Center"
                                                       Visibility="Hidden"
                                                       FontFamily="Segoe UI Symbol" />
                                            <controls:CombatantNamePanel x:Name="NamePanel"
                                                                         Grid.Column="1"
                                                                         Combatant="{Binding}" />
                                            <WrapPanel Grid.Row="1"
                                                       Grid.Column="1"
                                                       Margin="16, 0, 0, 0"
                                                       Orientation="Horizontal">
                                                <TextBlock>
                                                    <Run Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                                         Text="{Binding Source={x:Static resources:Resources.HitPointsLabel}, Mode=OneTime}" /> 
                                                    <Run Text="{Binding Path=Health.CurrentHitPoints, Mode=OneWay}" />/<Run Text="{Binding Health.MaxHealth, Mode=OneWay}" />
                                                </TextBlock>
                                            </WrapPanel>
                                        </Grid>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding IsCurrent}"
                                                         Value="True">
                                                <Setter TargetName="CurrentMarker"
                                                        Property="Visibility"
                                                        Value="Visible" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Health.IsDead}"
                                                         Value="True">
                                                <Setter TargetName="NamePanel"
                                                        Property="TextElement.Foreground"
                                                        Value="DarkRed" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Health.IsUnconscious}"
                                                         Value="True">
                                                <Setter TargetName="NamePanel"
                                                        Property="TextElement.Foreground"
                                                        Value="Red" />
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Grid>
                        <!--  Combat Data Column  -->
                        <Grid Grid.Column="1"
                              Margin="4,0,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <!--  Buttons  -->
                            <WrapPanel Orientation="Horizontal"
                                       Grid.Row="0"
                                       HorizontalAlignment="Right">
                                <Button Content="{Binding Source={x:Static resources:Resources.NextCombatantButton}}"
                                        Margin="4"
                                        Command="local:Commands.NextCombatant" />
                                <StackPanel Orientation="Horizontal"
                                            Margin="2, 0">
                                    <Button Content="{Binding Source={x:Static resources:Resources.DamageCombatantsButton}}"
                                            Margin="4"
                                            Command="local:Commands.DamageCombatants" />
                                    <Button Content="{Binding Source={x:Static resources:Resources.HealCombatantsButton}}"
                                            Margin="4"
                                            Command="local:Commands.HealCombatants" />
                                </StackPanel>
                                <Button Content="{Binding Source={x:Static resources:Resources.ManageCombatantsButton}}"
                                        Margin="4"
                                        Command="local:Commands.ManageCombatants" />
                                <Button Content="{Binding Source={x:Static resources:Resources.UndoButtonLabel}}"
                                        Margin="4"
                                        TextElement.FontFamily="Segoe UI Symbol"
                                        Command="local:Commands.Undo" />
                                <Button Content="{Binding Source={x:Static resources:Resources.EndButton}}"
                                        Margin="4"
                                        Command="local:Commands.EndCombat"
                                        CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combat}" />
                            </WrapPanel>
                            <Grid Grid.Row="1"
                                  Margin="4">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="4" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Row="0"
                                           Grid.Column="0"
                                           Text="{Binding Source={x:Static resources:Resources.CurrentRoundLabel}}" />
                                <TextBlock Grid.Row="0"
                                           Grid.Column="2"
                                           Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combat.Combat.Round}" />
                            </Grid>
                            <TabControl Grid.Row="2"
                                        SelectedIndex="0">
                                <TabItem Header="{Binding Source={x:Static vmresources:Resources.GeneralLabel}}">
                                    <controls:GeneralCombatantView Combatant="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}"
                                                                   Combat="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combat.Combat}" />
                                </TabItem>
                                <TabItem Header="{Binding Source={x:Static resources:Resources.SourceLabel}}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="5*" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <ContentPresenter Grid.Column="0"
                                                          Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant.Source.Source}"
                                                          ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.ObjectViewTemplate}}"
                                                          TextElement.Foreground="{StaticResource {x:Static controls:ResourceKeys.TextFontColor}}" />
                                        <controls:EffectsPanel Grid.Column="1"
                                                               Margin="4, 0, 0, 0"
                                                               Combat="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combat}"
                                                               Combatant="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}" />
                                        <GridSplitter Grid.Column="1"
                                                      Style="{StaticResource {x:Static controls:ResourceKeys.HorizontalSplitterStyle}}" />
                                    </Grid>
                                </TabItem>
                            </TabControl>
                        </Grid>
                        <GridSplitter Grid.Column="1"
                                      Style="{StaticResource {x:Static controls:ResourceKeys.HorizontalSplitterStyle}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  Control for resolving initiative ties  -->
    <Style TargetType="{x:Type controls:ResolveInitiatives}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ResolveInitiatives}">
                    <ControlTemplate.Resources>
                        <controls:InitiativeBrushConverter x:Key="InitiativeBrush" />
                    </ControlTemplate.Resources>
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="CombatantsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Resolver.Combatants}"
                                                  IsLiveSortingRequested="True">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="InitiativeOrder"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.LiveSortingProperties>
                                    <sys:String>InitiativeOrder</sys:String>
                                </CollectionViewSource.LiveSortingProperties>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <!--  Combatant list column  -->
                        <Grid Grid.Column="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <ListBox x:Name="PART_CombatantList"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                     controls:CombatantDragDrop.Combatants="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Resolver.Preparer.Preparer}"
                                     ItemsSource="{Binding Source={StaticResource CombatantsCollection}}"
                                     SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="10" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="10" />
                                            </Grid.ColumnDefinitions>
                                            <Border BorderThickness="2"
                                                    Margin="2"
                                                    BorderBrush="Transparent"
                                                    Background="{Binding Converter={StaticResource InitiativeBrush}}" />
                                            <Grid Grid.Column="1">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <controls:CombatantNamePanel Combatant="{Binding}" />
                                                <WrapPanel Orientation="Horizontal"
                                                           Grid.Row="1">
                                                    <TextBlock Margin="0,0,10,0"><Run Text="{Binding Source={x:Static resources:Resources.InitiativeTotalLabel},Mode=OneTime}" />:  <Run Text="{Binding InitiativeTotal}" /></TextBlock>
                                                    <TextBlock><Run Text="{Binding Source={x:Static resources:Resources.InitiativeModifierLabel},Mode=OneTime}" />:  <Run Text="{Binding InitiativeModifier}" /></TextBlock>
                                                </WrapPanel>
                                            </Grid>
                                            <Border Grid.Column="2"
                                                    BorderThickness="2"
                                                    Margin="2"
                                                    BorderBrush="Transparent"
                                                    Background="{Binding Converter={StaticResource InitiativeBrush}}" />
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <!--  Option Buttons  -->
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Button Grid.Row="1"
                                        Margin="0, 4"
                                        x:Name="PART_UpButton"
                                        Command="local:Commands.Up"
                                        CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}">
                                    <TextBlock Text="{Binding Source={x:Static resources:Resources.UpButton}}"
                                               FontFamily="Segoe UI Symbol" />
                                </Button>
                                <Button Grid.Row="2"
                                        Margin="0, 4"
                                        x:Name="PART_DownButton"
                                        Command="local:Commands.Down"
                                        CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}">
                                    <TextBlock Text="{Binding Source={x:Static resources:Resources.UpButton}}"
                                               FontFamily="Segoe UI Symbol"
                                               RenderTransformOrigin="0.5, 0.5">
                                        <TextBlock.RenderTransform>
                                            <RotateTransform Angle="180" />
                                        </TextBlock.RenderTransform>
                                    </TextBlock>
                                </Button>
                            </Grid>
                        </Grid>
                        <Grid Grid.Column="1"
                              Margin="4, 0, 0, 0">
                            <ContentPresenter Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}"
                                              ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.CombatantPreparerViewTemplate}}" />
                        </Grid>
                        <GridSplitter Grid.Column="1"
                                      Style="{StaticResource {x:Static controls:ResourceKeys.HorizontalSplitterStyle}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  View for damaging combatants during combat  -->
    <Style TargetType="{x:Type controls:DamageCombatants}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:DamageCombatants}">
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="CombatantsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Combat.Combatants}"
                                                  Filter="{x:Static controls:ActiveCombat.FilterOutInactiveCombatants}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Ordinal"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="DamageCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Damage.Combatants}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Combatant.Name"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Combatant.Ordinal"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="3*" />
                        </Grid.ColumnDefinitions>
                        <!--  Combatant List  -->
                        <Grid Grid.Column="0">
                            <ListBox x:Name="PART_CombatantList"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                     SelectionMode="Multiple"
                                     ItemsSource="{Binding Source={StaticResource CombatantsCollection}}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid IsHitTestVisible="False">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <controls:CombatantNamePanel Combatant="{Binding}" />
                                            <WrapPanel Grid.Row="1"
                                                       Orientation="Horizontal">
                                                <TextBlock>
                                                    <Run Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                                         Text="{Binding Source={x:Static resources:Resources.HitPointsLabel}, Mode=OneTime}" /> 
                                                    <Run Text="{Binding Path=Health.CurrentHitPoints, Mode=OneWay}" />/<Run Text="{Binding Health.MaxHealth, Mode=OneWay}" />
                                                </TextBlock>
                                            </WrapPanel>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Grid>
                        <!--  Damage Information  -->
                        <Grid Grid.Column="1"
                              Margin="4, 0, 0, 0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <!--  General Damage Information  -->
                            <Grid Grid.Row="0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label Grid.Row="0"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.AmountLabel}}" />
                                <TextBox Grid.Row="0"
                                         Grid.Column="1"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Damage.Amount, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                            <!--  Damage Modifiers  -->
                            <Grid Grid.Row="1"
                                  Margin="0, 0, 0, 4"
                                  Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.HasDamageModifiers, Converter={StaticResource BooleanToVisibility}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <ComboBox Grid.Column="0"
                                          x:Name="PART_DamageModifier"
                                          DisplayMemberPath="Display"
                                          SelectedValuePath="Value" />
                                <ContentPresenter Grid.Column="1"
                                                  Content="{Binding ElementName=PART_DamageModifier, Path=SelectedValue}">
                                    <ContentPresenter.Resources>
                                        <DataTemplate DataType="{x:Type vm:BypassDamageModifiersViewModel}">
                                            <!--  Nothing to Display Here  -->
                                        </DataTemplate>
                                        <DataTemplate DataType="{x:Type vm:ApplyDamageReductionViewModel}">
                                            <Grid DataContext="{Binding RelativeSource={RelativeSource AncestorType={x:Type ContentPresenter}}, Path=Content}">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                </Grid.RowDefinitions>
                                                <CheckBox Grid.ColumnSpan="3"
                                                          Content="{Binding Source={x:Static resources:Resources.ApplyToTotalLabel}}"
                                                          IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type controls:DamageCombatants}}, Path=ViewModel.Damage.ApplyDamageReductionToTotal}" />
                                                <Label Grid.Row="1"
                                                       Content="{Binding Source={x:Static resources:Resources.DamageTypesLabel}}"
                                                       Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                                       VerticalAlignment="Top" />
                                                <ItemsControl Grid.Row="1"
                                                              Grid.Column="1"
                                                              VerticalAlignment="Center"
                                                              ItemsSource="{Binding Types}">
                                                    <ItemsControl.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <WrapPanel Orientation="Horizontal" />
                                                        </ItemsPanelTemplate>
                                                    </ItemsControl.ItemsPanel>
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <TextBlock x:Name="Item"
                                                                       VerticalAlignment="Center"
                                                                       Foreground="Gray"
                                                                       Margin="4, 0"
                                                                       Text="{Binding Type}" />
                                                            <DataTemplate.Triggers>
                                                                <DataTrigger Binding="{Binding Selected}"
                                                                             Value="True">
                                                                    <DataTrigger.Setters>
                                                                        <Setter Property="Foreground"
                                                                                TargetName="Item"
                                                                                Value="White" />
                                                                    </DataTrigger.Setters>
                                                                </DataTrigger>
                                                            </DataTemplate.Triggers>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                                <ToggleButton Grid.Row="1"
                                                              Grid.Column="2"
                                                              x:Name="TogglePopup"
                                                              FontFamily="Segoe UI Symbol"
                                                              Content="{Binding Source={x:Static resources:Resources.EditButton}}" />
                                                <Popup IsOpen="{Binding ElementName=TogglePopup, Path=IsChecked}"
                                                       StaysOpen="False"
                                                       MinHeight="100"
                                                       MinWidth="100"
                                                       Width="{Binding RelativeSource={RelativeSource Self}, Path=PlacementTarget.ActualWidth}"
                                                       Placement="Bottom"
                                                       DataContext="{Binding RelativeSource={RelativeSource Self}, Path=PlacementTarget.DataContext}"
                                                       PlacementTarget="{Binding RelativeSource={RelativeSource AncestorType={x:Type Grid}}}">
                                                    <ItemsControl ItemsSource="{Binding Types}">
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <CheckBox IsChecked="{Binding Selected}"
                                                                          Content="{Binding Type}" />
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </Popup>
                                            </Grid>
                                        </DataTemplate>
                                    </ContentPresenter.Resources>
                                </ContentPresenter>
                            </Grid>
                            <!--  Combatant Specific Damage Information  -->
                            <ScrollViewer Grid.Row="2"
                                          ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                          ScrollViewer.VerticalScrollBarVisibility="Auto"
                                          PanningMode="VerticalOnly">
                                <ItemsControl ItemsSource="{Binding Source={StaticResource DamageCollection}}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border BorderThickness="0,1"
                                                    BorderBrush="{StaticResource {x:Static controls:ResourceKeys.FadeFromCenterBrush}}">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Button Grid.RowSpan="2"
                                                            Grid.Column="0"
                                                            VerticalAlignment="Center"
                                                            TextElement.FontFamily="Segoe UI Symbol"
                                                            Content="{Binding Source={x:Static resources:Resources.ViewObjectButton}}"
                                                            Command="local:Commands.ViewObject"
                                                            CommandParameter="{Binding Path=Combatant.Source.Source}" />
                                                    <controls:CombatantNamePanel Grid.Column="1"
                                                                                 Combatant="{Binding Combatant}"
                                                                                 HorizontalAlignment="Left" />
                                                    <WrapPanel Grid.Column="1"
                                                               Grid.Row="1"
                                                               VerticalAlignment="Top">
                                                        <Label  Content="{Binding Source={x:Static resources:Resources.AmountLabel}}" />
                                                        <TextBox Text="{Binding Amount, UpdateSourceTrigger=PropertyChanged}"
                                                                 Width="60" />
                                                        <ComboBox ItemsSource="{Binding Source={x:Static controls:DamageCombatants.DamageModifiers}}"
                                                                  Margin="4, 0"
                                                                  VerticalAlignment="Center"
                                                                  SelectedValue="{Binding Modifier}"
                                                                  DisplayMemberPath="Display"
                                                                  SelectedValuePath="Value" />
                                                        <StackPanel Orientation="Horizontal">
                                                            <Label Content="{Binding Source={x:Static resources:Resources.ActualAmountLabel}}" />
                                                            <TextBlock Text="{Binding ActualAmount}"
                                                                       VerticalAlignment="Center"
                                                                       Foreground="HotPink"
                                                                       Margin="4, 0" />
                                                        </StackPanel>
                                                        <CheckBox IsChecked="{Binding IsLethal}"
                                                                  VerticalAlignment="Center"
                                                                  Margin="4,0,0,0"
                                                                  Content="{Binding Source={x:Static resources:Resources.IsLethalLabel}}" />
                                                    </WrapPanel>
                                                    <ContentPresenter Grid.Column="2"
                                                                      Grid.RowSpan="2"
                                                                      Content="{Binding Path=Combatant.Source.Source, Converter={StaticResource MonsterConverter}}"
                                                                      ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.MonsterDefenseTemplate}}"
                                                                      Visibility="{Binding RelativeSource={RelativeSource Self}, Path=Content, Converter={StaticResource ReferenceToVisibility}}" />
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Grid>
                        <GridSplitter Grid.Column="1"
                                      Style="{StaticResource {x:Static controls:ResourceKeys.HorizontalSplitterStyle}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  View for healing combatants during combat  -->
    <Style TargetType="{x:Type controls:HealCombatants}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:HealCombatants}">
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="CombatantsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Combat.Combatants}"
                                                  Filter="{x:Static controls:ActiveCombat.FilterOutInactiveCombatants}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Ordinal"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="DamageCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Healing.Combatants}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Combatant.Name"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Combatant.Ordinal"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="2*" />
                        </Grid.ColumnDefinitions>
                        <!--  Combatant List  -->
                        <Grid Grid.Column="0">
                            <ListBox x:Name="PART_CombatantList"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                     SelectionMode="Multiple"
                                     ItemsSource="{Binding Source={StaticResource CombatantsCollection}}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid IsHitTestVisible="False">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <controls:CombatantNamePanel Combatant="{Binding}" />
                                            <WrapPanel Grid.Row="1"
                                                       Orientation="Horizontal">
                                                <TextBlock>
                                                    <Run Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                                         Text="{Binding Source={x:Static resources:Resources.HitPointsLabel}, Mode=OneTime}" /> 
                                                    <Run Text="{Binding Path=Health.CurrentHitPoints, Mode=OneWay}" />/<Run Text="{Binding Health.MaxHealth, Mode=OneWay}" />
                                                </TextBlock>
                                            </WrapPanel>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Grid>
                        <!--  Damage Information  -->
                        <Grid Grid.Column="1"
                              Margin="4, 0, 0, 0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <!--  General Damage Information  -->
                            <Grid Grid.Row="0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label Grid.Row="0"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.AmountLabel}}" />
                                <TextBox Grid.Row="0"
                                         Grid.Column="1"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Healing.Amount, UpdateSourceTrigger=PropertyChanged}"
                                         MaxLength="10"
                                         windows:TextBoxHelper.DataType="Integer" />
                                <CheckBox Grid.Row="1"
                                          Grid.Column="1"
                                          Content="{Binding Source={x:Static resources:Resources.AllowOverHealLabel}}"
                                          IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Healing.Overheal}" />
                                <CheckBox Grid.Row="2"
                                          Grid.Column="1"
                                          Content="{Binding Source={x:Static resources:Resources.IsMagicalLabel}}"
                                          IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Healing.IsMagical}" />
                            </Grid>
                            <!--  Combatant Specific Damage Information  -->
                            <ListBox Grid.Row="1"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                                     ItemsSource="{Binding Source={StaticResource DamageCollection}}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <controls:CombatantNamePanel Combatant="{Binding Combatant}"
                                                                         HorizontalAlignment="Left" />
                                            <WrapPanel Grid.Row="1">
                                                <Label Content="{Binding Source={x:Static resources:Resources.AmountLabel}}" />
                                                <TextBox Text="{Binding Amount, UpdateSourceTrigger=PropertyChanged}"
                                                         Width="60" />
                                                <CheckBox IsChecked="{Binding Overheal}"
                                                          VerticalAlignment="Center"
                                                          Margin="4,0,0,0"
                                                          Content="{Binding Source={x:Static resources:Resources.AllowOverHealLabel}}" />
                                                <CheckBox IsChecked="{Binding IsMagical}"
                                                          VerticalAlignment="Center"
                                                          Margin="4,0,0,0"
                                                          Content="{Binding Source={x:Static resources:Resources.IsMagicalLabel}}" />
                                            </WrapPanel>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Grid>
                        <GridSplitter Grid.Column="1"
                                      Style="{StaticResource {x:Static controls:ResourceKeys.HorizontalSplitterStyle}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!--  View for manageing combat and combatants  -->
    <Style TargetType="{x:Type controls:ManageCombatants}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ManageCombatants}">
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="CombatantsByName"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Combat.Combatants}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Ordinal"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="CombatantsByInitiative"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Combat.Combatants}"
                                                  IsLiveSortingRequested="True">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="InitiativeOrder"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.LiveSortingProperties>
                                    <sys:String>InitiativeOrder</sys:String>
                                </CollectionViewSource.LiveSortingProperties>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="2*" />
                        </Grid.ColumnDefinitions>
                        <!--  Combatant List  -->
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <!--  Sort Options  -->
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.SortByLabel}}" />
                                <ComboBox Grid.Column="1"
                                          x:Name="SortOrderCombo"
                                          SelectedIndex="0"
                                          VerticalAlignment="Center"
                                          HorizontalAlignment="Stretch">
                                    <!--  Sort by Name  -->
                                    <ComboBoxItem DataContext="{Binding Source={StaticResource CombatantsByName}}">
                                        <TextBlock Text="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                                    </ComboBoxItem>
                                    <!--  Sort By Initiative, if moved from Index 1 then the drag/drop ContentTemplate.Trigger below needs to be updated  -->
                                    <ComboBoxItem DataContext="{Binding Source={StaticResource CombatantsByInitiative}}">
                                        <TextBlock Text="{Binding Source={x:Static resources:Resources.InitiativeOrderLabel}}" />
                                    </ComboBoxItem>
                                </ComboBox>
                            </Grid>
                            <!--  Combatant List  -->
                            <ListBox Grid.Row="1"
                                     x:Name="PART_CombatantList"
                                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                     ItemsSource="{Binding ElementName=SortOrderCombo, Path=SelectedValue.DataContext}"
                                     SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent},Path=SelectedCombatant}">
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="{x:Type ListBoxItem}"
                                           BasedOn="{StaticResource {x:Static controls:ResourceKeys.ListBoxItemStyle}}">
                                        <Setter Property="ContextMenu"
                                                Value="{StaticResource CombatantMenu}" />
                                    </Style>
                                </ListBox.ItemContainerStyle>
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <controls:CombatantNamePanel Combatant="{Binding}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <!--  Up/Down Buttons  -->
                            <Grid x:Name="UpDownGrid"
                                  Grid.RowSpan="2"
                                  Grid.Column="1"
                                  Margin="4, 0"
                                  Visibility="Collapsed">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Button Grid.Row="1"
                                        Margin="0, 4"
                                        x:Name="PART_UpButton"
                                        Command="local:Commands.Up"
                                        CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}">
                                    <TextBlock Text="{Binding Source={x:Static resources:Resources.UpButton}}"
                                               FontFamily="Segoe UI Symbol" />
                                </Button>
                                <Button Grid.Row="2"
                                        Margin="0, 4"
                                        x:Name="PART_DownButton"
                                        Command="local:Commands.Down"
                                        CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}">
                                    <TextBlock Text="{Binding Source={x:Static resources:Resources.UpButton}}"
                                               FontFamily="Segoe UI Symbol"
                                               RenderTransformOrigin="0.5, 0.5">
                                        <TextBlock.RenderTransform>
                                            <RotateTransform Angle="180" />
                                        </TextBlock.RenderTransform>
                                    </TextBlock>
                                </Button>
                            </Grid>
                        </Grid>
                        <!--  Combat/Combatant Information  -->
                        <Grid Grid.Column="1"
                              Margin="4, 0, 0, 0">
                            <TabControl SelectedIndex="0">
                                <TabItem Header="{Binding Source={x:Static vmresources:Resources.GeneralLabel}}">
                                    <controls:GeneralCombatantView Combatant="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant}"
                                                                   Combat="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Combat.Combat}" />
                                </TabItem>
                                <TabItem>
                                    <TabItem.Header>
                                        <Label Margin="0"
                                               Padding="0"
                                               Content="{Binding Source={x:Static resources:Resources.PrepareInfoLabel}}"
                                               ToolTip="{Binding Source={x:Static resources:Resources.PrepareInfoToolTip}}" />
                                    </TabItem.Header>
                                    <ContentPresenter Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant.PreparedInfo}"
                                                      ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.CombatantPreparerViewTemplate}}"
                                                      TextElement.Foreground="{StaticResource {x:Static controls:ResourceKeys.TextFontColor}}" />
                                </TabItem>
                                <TabItem Header="{Binding Source={x:Static resources:Resources.SourceLabel}}">
                                    <ContentPresenter Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCombatant.Source.Source}"
                                                      ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.ObjectViewTemplate}}"
                                                      TextElement.Foreground="{StaticResource {x:Static controls:ResourceKeys.TextFontColor}}" />
                                </TabItem>
                            </TabControl>
                        </Grid>
                        <GridSplitter Grid.Column="1"
                                      Style="{StaticResource {x:Static controls:ResourceKeys.HorizontalSplitterStyle}}" />
                    </Grid>
                    <ControlTemplate.Triggers>
                        <!--  Enable/Disable Drag/Drop based on view  -->
                        <Trigger SourceName="SortOrderCombo"
                                 Property="SelectedIndex"
                                 Value="1">
                            <Setter Property="controls:CombatantDragDrop.Combatants"
                                    Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Combat.Combat}"
                                    TargetName="PART_CombatantList" />
                            <Setter Property="Visibility"
                                    Value="Visible"
                                    TargetName="UpDownGrid" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  View for managing monsters in a campaign  -->
    <Style TargetType="{x:Type controls:ManageMonsters}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ManageMonsters}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"
                                              MinWidth="40" />
                            <ColumnDefinition Width="4*" />
                        </Grid.ColumnDefinitions>
                        <!--  Monster List  -->
                        <controls:MonsterList Grid.Column="0"
                                              x:Name="PART_MonsterList"
                                              Monsters="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Monsters}"
                                              SelectedMonster="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedMonster}"
                                              Filter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Filter}" />
                        <!--  Monster View  -->
                        <Grid Grid.Column="1"
                              Margin="4,0,0,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <controls:AddRemoveEdit Grid.Row="0"
                                                    HorizontalAlignment="Right"
                                                    AllowEdit="True"
                                                    AllowCopy="True"
                                                    CommandParameter="{Binding ElementName=PART_MonsterList, Path=SelectedMonster}" />
                            <ScrollViewer Grid.Row="1"
                                          HorizontalScrollBarVisibility="Disabled"
                                          VerticalScrollBarVisibility="Auto"
                                          PanningMode="VerticalOnly">
                                <ContentPresenter Content="{Binding ElementName=PART_MonsterList, Path=SelectedMonster, Converter={StaticResource MonsterConverter}}"
                                                  ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.MonsterViewTemplate}}"
                                                  Visibility="{Binding ElementName=PART_MonsterList, Path=SelectedMonster, Converter={StaticResource ReferenceToVisibility}}" />
                            </ScrollViewer>
                        </Grid>
                        <GridSplitter Grid.Column="1"
                                      Style="{StaticResource {x:Static controls:ResourceKeys.HorizontalSplitterStyle}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="{x:Type controls:MonsterList}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:MonsterList}">
                    <Grid Grid.Column="0"
                          x:Name="PART_MonsterListPane">
                        <Grid.Resources>
                            <CollectionViewSource x:Key="MonstersCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent},Path=Monsters}"
                                                  IsLiveSortingRequested="True"
                                                  IsLiveGroupingRequested="True">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="Name"
                                                              Converter="{StaticResource NameGroupingConverter}" />
                                </CollectionViewSource.GroupDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="MonstersByTypeCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Monsters}"
                                                  IsLiveSortingRequested="True"
                                                  IsLiveGroupingRequested="True">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Stats[type].Value"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="Stats[type].Value" />
                                </CollectionViewSource.GroupDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="MonstersByChallengeRatingCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Monsters}"
                                                  IsLiveSortingRequested="True"
                                                  IsLiveGroupingRequested="True">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Stats[challengeRating].Value"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="Stats[challengeRating].Value" />
                                </CollectionViewSource.GroupDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <!--  Sorting Options  -->
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Label Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.SortByLabel}}" />
                            <!--  Combobox for choosing sort order.  If the order of the items changes, then the corresponding ControlTemplate.Triggers must change below as well  -->
                            <ComboBox x:Name="SortCombo"
                                      Grid.Column="1"
                                      SelectedIndex="0">
                                <ComboBoxItem Tag="{Binding Source={StaticResource MonstersCollection}}">
                                    <TextBlock Text="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                                </ComboBoxItem>
                                <ComboBoxItem Tag="{Binding Source={StaticResource MonstersByTypeCollection}}">
                                    <TextBlock Text="{Binding Source={x:Static vmresources:Resources.TypeLabel}}" />
                                </ComboBoxItem>
                                <ComboBoxItem Tag="{Binding Source={StaticResource MonstersByChallengeRatingCollection}}">
                                    <TextBlock Text="{Binding Source={x:Static vmresources:Resources.ChallengeRatingLabel}}" />
                                </ComboBoxItem>
                            </ComboBox>
                        </Grid>
                        <!--  ListBox containing Monsters  -->
                        <controls:FilterableList Grid.Row="1"
                                                 x:Name="PART_MonsterList"
                                                 TextSearch.TextPath="Name"
                                                 Items="{Binding ElementName=SortCombo, Path=SelectedValue.Tag}"
                                                 SelectedItem="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedMonster}"
                                                 Filter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Filter}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="{x:Type controls:MonsterEditor}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:MonsterEditor}">
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="StatCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent},Path=ViewModel.Stats}">
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="Category" />
                                </CollectionViewSource.GroupDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="SourcesCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Sources}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <!--  Required Stats  -->
                        <Grid Grid.Row="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Row="0"
                                       Grid.ColumnSpan="2"
                                       Text="{Binding Source={x:Static resources:Resources.RequiredStatsHeader}}"
                                       FontSize="{StaticResource {x:Static controls:ResourceKeys.HeaderFontSize}}"
                                       Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}" />
                            <Label Grid.Row="1"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                            <TextBox Grid.Row="1"
                                     Grid.Column="1"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Name, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="2"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.HitDiceLabel}}" />
                            <TextBox Grid.Row="2"
                                     Grid.Column="1"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.HitDice, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="3"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.InitiativeModifierLabel}}" />
                            <TextBox Grid.Row="3"
                                     Grid.Column="1"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.InitiativeModifier, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="4"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.FastHealingLabel}}" />
                            <TextBox Grid.Row="4"
                                     Grid.Column="1"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.FastHealing, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="5"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.UnconsciousAtLabel}}" />
                            <TextBox Grid.Row="5"
                                     Grid.Column="1"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.UnconsciousAt, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="6"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.DeadAtLabel}}" />
                            <TextBox Grid.Row="6"
                                     Grid.Column="1"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.DeadAt, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="7"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.SourceLabel}}" />
                            <ComboBox Grid.Row="7"
                                      Grid.Column="1"
                                      Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Source, UpdateSourceTrigger=PropertyChanged}"
                                      ItemsSource="{Binding Source={StaticResource SourcesCollection}}"
                                      SelectedItem="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Source}"
                                      IsEditable="True" />
                        </Grid>
                        <!--  Other Stats  -->
                        <ScrollViewer Grid.Row="1"
                                      HorizontalScrollBarVisibility="Disabled"
                                      VerticalScrollBarVisibility="Auto"
                                      Grid.IsSharedSizeScope="True"
                                      PanningMode="VerticalOnly">
                            <ItemsControl ItemsSource="{Binding Source={StaticResource StatCollection}}"
                                          Margin="4"
                                          Focusable="False">
                                <ItemsControl.Resources>
                                    <DataTemplate DataType="{x:Type monsterStats:StringStatViewModel}">
                                        <Grid>
                                            <Grid.Resources>
                                                <CollectionViewSource x:Key="SourceCollection"
                                                                      Source="{Binding Source}">
                                                    <CollectionViewSource.SortDescriptions>
                                                        <comp:SortDescription PropertyName="."
                                                                              Direction="Ascending" />
                                                    </CollectionViewSource.SortDescriptions>
                                                </CollectionViewSource>
                                            </Grid.Resources>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition SharedSizeGroup="Labels" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0"
                                                   Content="{Binding Name}" />
                                            <TextBox Grid.Column="1"
                                                     x:Name="TextBox"
                                                     Visibility="Collapsed"
                                                     AcceptsReturn="True"
                                                     AcceptsTab="True"
                                                     Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}" />
                                            <ComboBox Grid.Column="1"
                                                      x:Name="ComboBox"
                                                      Visibility="Visible"
                                                      Text="{Binding Value, UpdateSourceTrigger=PropertyChanged}"
                                                      SelectedValue="{Binding Value}"
                                                      ItemsSource="{Binding Path=Source}"
                                                      IsEditable="{Binding CanAddNew}" />
                                        </Grid>
                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding Source}"
                                                         Value="{x:Null}">
                                                <Setter Property="Visibility"
                                                        Value="Visible"
                                                        TargetName="TextBox" />
                                                <Setter Property="Visibility"
                                                        Value="Collapsed"
                                                        TargetName="ComboBox" />
                                            </DataTrigger>
                                        </DataTemplate.Triggers>
                                    </DataTemplate>
                                    <DataTemplate DataType="{x:Type monsterStats:AlignmentStatViewModel}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition SharedSizeGroup="Labels" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0"
                                                   Content="{Binding Name}" />
                                            <ComboBox Grid.Column="1"
                                                      SelectedValue="{Binding Value}"
                                                      ItemsSource="{Binding Source={x:Static controls:AlignmentExtensions.ItemsSource}}"
                                                      DisplayMemberPath="Display"
                                                      SelectedValuePath="Value" />
                                        </Grid>
                                    </DataTemplate>
                                    <DataTemplate DataType="{x:Type monsterStats:SizeStatViewModel}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition SharedSizeGroup="Labels" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0"
                                                   Content="{Binding Name}" />
                                            <ComboBox Grid.Column="1"
                                                      SelectedValue="{Binding Value}"
                                                      ItemsSource="{Binding Source={x:Static controls:MonsterSizeExtensions.ItemsSource}}"
                                                      DisplayMemberPath="Display"
                                                      SelectedValuePath="Value" />
                                        </Grid>
                                    </DataTemplate>
                                    <DataTemplate DataType="{x:Type monsterStats:CollectionStatViewModel}">
                                        <Grid>
                                            <Grid.Resources>
                                                <CollectionViewSource x:Key="ValuesCollection"
                                                                      Source="{Binding Value}">
                                                    <CollectionViewSource.SortDescriptions>
                                                        <comp:SortDescription PropertyName="."
                                                                              Direction="Ascending" />
                                                    </CollectionViewSource.SortDescriptions>
                                                </CollectionViewSource>
                                            </Grid.Resources>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition SharedSizeGroup="Labels" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0"
                                                   Content="{Binding Name}" />
                                            <Grid Grid.Column="1">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <ListBox x:Name="List"
                                                         ItemsSource="{Binding Source={StaticResource ValuesCollection}}" />
                                                <controls:AddRemoveEdit Grid.Column="1"
                                                                        Orientation="Vertical"
                                                                        AllowEdit="False"
                                                                        CommandParameter="{Binding ElementName=List, Path=SelectedValue}" />
                                            </Grid>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.Resources>
                                <ItemsControl.GroupStyle>
                                    <GroupStyle>
                                        <GroupStyle.HeaderTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Name}"
                                                           Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                                           FontSize="{StaticResource {x:Static controls:ResourceKeys.SubheaderFontSize}}" />
                                            </DataTemplate>
                                        </GroupStyle.HeaderTemplate>
                                    </GroupStyle>
                                </ItemsControl.GroupStyle>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!--  Wizard Page for choose a source to import monsters from  -->
    <DataTemplate x:Key="{x:Static controls:ResourceKeys.BeginMonsterImportTemplate}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Label Grid.Row="0"
                   Content="{Binding Source={x:Static resources:Resources.ChooseSourceLabel}}" />
            <ComboBox Grid.Row="1"
                      SelectedValue="{Binding Path=Reader}"
                      SelectedValuePath="Tag"
                      SelectedIndex="0">
                <ComboBoxItem Tag="pfsrd">
                    <TextBlock Text="{Binding Source={x:Static resources:Resources.PfsrdImportLabel}}" />
                </ComboBoxItem>
                <ComboBoxItem Tag="GameScreen">
                    <TextBlock Text="{Binding Source={x:Static resources:Resources.d20GameScreenLabel}}" />
                </ComboBoxItem>
            </ComboBox>
        </Grid>
    </DataTemplate>

    <Style TargetType="{x:Type controls:ChooseCombatantTemplateSource}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ChooseCombatantTemplateSource}">
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="2*" />
                        </Grid.ColumnDefinitions>
                        <controls:MonsterList Monsters="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Campaign.MonsterManager.Monsters}"
                                              SelectedMonster="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SelectedSource}" />
                        <ContentPresenter Grid.Column="1"
                                          Margin="4,0,0,0"
                                          Content="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SelectedSource}"
                                          ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.ObjectViewTemplate}}" />
                        <GridSplitter Grid.Column="1"
                                      Style="{StaticResource {x:Static controls:ResourceKeys.HorizontalSplitterStyle}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <DataTemplate x:Key="{x:Static controls:ResourceKeys.BeginSpellImportTemplate}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Label Grid.Row="0"
                   Content="{Binding Source={x:Static resources:Resources.ChooseSourceLabel}}" />
            <ComboBox Grid.Row="1"
                      SelectedValue="{Binding Path=Reader}"
                      SelectedValuePath="Tag"
                      SelectedIndex="0">
                <ComboBoxItem Tag="pfsrd">
                    <TextBlock Text="{Binding Source={x:Static resources:Resources.PfsrdImportLabel}}" />
                </ComboBoxItem>
            </ComboBox>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="{x:Static controls:ResourceKeys.BeginMagicItemImportTemplate}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Label Grid.Row="0"
                   Content="{Binding Source={x:Static resources:Resources.ChooseSourceLabel}}" />
            <ComboBox Grid.Row="1"
                      SelectedValue="{Binding Path=Reader}"
                      SelectedValuePath="Tag"
                      SelectedIndex="0">
                <ComboBoxItem Tag="pfsrd">
                    <TextBlock Text="{Binding Source={x:Static resources:Resources.PfsrdImportLabel}}" />
                </ComboBoxItem>
            </ComboBox>
        </Grid>
    </DataTemplate>

    <!--  View for managing players  -->
    <Style TargetType="{x:Type controls:ManagePlayers}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ManagePlayers}">
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="PlayerCharactersCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Characters}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="4*" />
                        </Grid.ColumnDefinitions>
                        <ListBox x:Name="PART_PlayerCharacterList"
                                 ItemsSource="{Binding Source={StaticResource PlayerCharactersCollection}}">
                            <ListBox.ItemContainerStyle>
                                <Style TargetType="{x:Type ListBoxItem}"
                                       BasedOn="{StaticResource {x:Static controls:ResourceKeys.ListBoxItemStyle}}">
                                    <Setter Property="HorizontalContentAlignment"
                                            Value="Stretch" />
                                </Style>
                            </ListBox.ItemContainerStyle>
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding Name}" />
                                        <TextBlock Grid.Column="2"
                                                   Margin="4,0,0,0"
                                                   Text="{Binding Player}"
                                                   TextTrimming="CharacterEllipsis" />
                                    </Grid>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                        <Grid Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <controls:AddRemoveEdit AllowEdit="True"
                                                    CommandParameter="{Binding ElementName=PART_PlayerCharacterList, Path=SelectedValue}" />
                            <ContentPresenter Grid.Row="1"
                                              Content="{Binding ElementName=PART_PlayerCharacterList, Path=SelectedValue}"
                                              ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.ObjectViewTemplate}}" />
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:PlayerCharacterEditor}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:PlayerCharacterEditor}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Label Grid.Row="0"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                        <TextBox Grid.Row="0"
                                 Grid.Column="1"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Character.Name, UpdateSourceTrigger=PropertyChanged}" />
                        <Label Grid.Row="1"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.PlayerNameLabel}}" />
                        <TextBox Grid.Row="1"
                                 Grid.Column="1"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Character.Player, UpdateSourceTrigger=PropertyChanged}" />
                        <Label Grid.Row="2"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.HitPointsLabel}}" />
                        <TextBox Grid.Row="2"
                                 Grid.Column="1"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Character.HitDice, UpdateSourceTrigger=PropertyChanged}" />
                        <Label Grid.Row="3"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.InitiativeModifierLabel}}" />
                        <TextBox Grid.Row="3"
                                 Grid.Column="1"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Character.InitiativeModifier, UpdateSourceTrigger=PropertyChanged}" />
                        <CheckBox Grid.Row="4"
                                  Grid.Column="1"
                                  Content="{Binding Source={x:Static resources:Resources.IncludeInCombatLabel}}"
                                  IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Character.IncludeInCombat}" />
                        <Label Grid.Row="5"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.LightRadiusLabel}}" />
                        <TextBox Grid.Row="5"
                                 Grid.Column="1"
                                 windows:TextBoxHelper.DataType="Integer"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Character.LightRadius, UpdateSourceTrigger=PropertyChanged}" />
                        <Label Grid.Row="6"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.SensesLabel}}" />
                        <TextBox Grid.Row="6"
                                 Grid.Column="1"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Character.Senses, UpdateSourceTrigger=PropertyChanged}" />
                        <Label Grid.Row="7"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.LanguagesLabel}}" />
                        <TextBox Grid.Row="7"
                                 Grid.Column="1"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Character.Languages, UpdateSourceTrigger=PropertyChanged}" />
                        <Label Grid.Row="8"
                               Grid.Column="0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static vmresources:Resources.AlignmentLabel}}" />
                        <ComboBox Grid.Row="8"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Character.Alignment}"
                                  ItemsSource="{Binding Source={x:Static controls:AlignmentExtensions.ItemsSource}}"
                                  DisplayMemberPath="Display"
                                  SelectedValuePath="Value" />
                        <Label Grid.Row="9"
                               Grid.Column="0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.NotesLabel}}" />
                        <controls:StringListEditor Grid.Row="9"
                                                   Grid.Column="1"
                                                   CanAddNew="True"
                                                   StringCollection="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Character.Notes}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!--
    Control for editing a list of strings
    -->
    <Style TargetType="{x:Type controls:StringListEditor}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:StringListEditor}">
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="StringCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=StringCollection}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <ListBox Grid.Row="0"
                                 x:Name="PART_StringList"
                                 ItemsSource="{Binding Source={StaticResource StringCollection}}"
                                 SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedValue}"
                                 SelectedItem="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedItem}" />
                        <controls:AddRemoveEdit Grid.Row="1"
                                                CommandParameter="{Binding ElementName=PART_StringList, Path=SelectedValue}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <ControlTemplate x:Key="{x:Static controls:ResourceKeys.StringListEditorSideBySideTemplate}"
                     TargetType="{x:Type controls:StringListEditor}">
        <Grid>
            <Grid.Resources>
                <CollectionViewSource x:Key="StringCollection"
                                      Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=StringCollection}">
                    <CollectionViewSource.SortDescriptions>
                        <comp:SortDescription PropertyName="."
                                              Direction="Ascending" />
                    </CollectionViewSource.SortDescriptions>
                </CollectionViewSource>
            </Grid.Resources>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <ListBox Grid.Column="0"
                     x:Name="PART_StringList"
                     ItemsSource="{Binding Source={StaticResource StringCollection}}"
                     SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedValue}"
                     SelectedItem="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedItem}" />
            <controls:AddRemoveEdit Grid.Column="1"
                                    Orientation="Vertical"
                                    CommandParameter="{Binding ElementName=PART_StringList, Path=SelectedValue}" />
        </Grid>
    </ControlTemplate>

    <Style TargetType="{x:Type controls:ManageMonsterTypes}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ManageMonsterTypes}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Label Grid.Row="0"
                               Grid.Column="0"
                               HorizontalAlignment="Center"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               FontSize="{StaticResource {x:Static controls:ResourceKeys.SubheaderFontSize}}"
                               Content="{Binding Source={x:Static resources:Resources.MonsterTypesLabel}}" />
                        <controls:StringListEditor Grid.Row="1"
                                                   Grid.Column="0"
                                                   x:Name="PART_Types"
                                                   Margin="4"
                                                   StringCollection="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.MonsterTypes}" />
                        <Label Grid.Row="0"
                               Grid.Column="1"
                               HorizontalAlignment="Center"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               FontSize="{StaticResource {x:Static controls:ResourceKeys.SubheaderFontSize}}"
                               Content="{Binding Source={x:Static vmresources:Resources.SubtypesLabel}}" />
                        <controls:StringListEditor Grid.Row="1"
                                                   Grid.Column="1"
                                                   x:Name="PART_TypeSubTypes"
                                                   Margin="4"
                                                   StringCollection="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SubTypes}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="{x:Type controls:ManageSpells}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ManageSpells}">
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="SpellsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Spells}"
                                                  IsLiveSortingRequested="True"
                                                  IsLiveGroupingRequested="True">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="Name"
                                                              Converter="{StaticResource NameGroupingConverter}" />
                                </CollectionViewSource.GroupDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="4*" />
                        </Grid.ColumnDefinitions>
                        <!--  Spell List Column  -->
                        <Grid Grid.Column="0">
                            <controls:SpellList x:Name="PART_SpellList"
                                                Grid.Row="3"
                                                Spells="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Spells}"
                                                SelectedSpell="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedSpell}"
                                                Filter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Filter}" />
                        </Grid>
                        <!--  Spell View Column  -->
                        <Grid Grid.Column="1"
                              Margin="4, 0, 0, 0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <controls:AddRemoveEdit Margin="4"
                                                    AllowEdit="True"
                                                    AllowCopy="True" />
                            <ScrollViewer Grid.Row="1"
                                          HorizontalScrollBarVisibility="Hidden"
                                          VerticalScrollBarVisibility="Auto"
                                          PanningMode="VerticalOnly">
                                <ContentPresenter Visibility="{Binding ElementName=PART_SpellList, Path=SelectedSpell, Converter={StaticResource ReferenceToVisibility}}"
                                                  Content="{Binding ElementName=PART_SpellList, Path=SelectedSpell}"
                                                  ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.SpellTemplate}}" />
                            </ScrollViewer>
                        </Grid>
                        <GridSplitter Grid.Column="1"
                                      Style="{StaticResource {x:Static controls:ResourceKeys.HorizontalSplitterStyle}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!--  Control for displaying a list of spells  -->
    <Style TargetType="{x:Type controls:SpellList}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:SpellList}">
                    <Grid x:Name="rootGrid">
                        <Grid.Resources>
                            <CollectionViewSource x:Key="SpellsByNameCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Spells}"
                                                  IsLiveSortingRequested="True"
                                                  IsLiveGroupingRequested="True"
                                                  IsLiveFilteringRequested="True">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="Name"
                                                              Converter="{StaticResource NameGroupingConverter}" />
                                </CollectionViewSource.GroupDescriptions>
                                <CollectionViewSource.LiveSortingProperties>
                                    <sys:String>Name</sys:String>
                                </CollectionViewSource.LiveSortingProperties>
                                <CollectionViewSource.LiveGroupingProperties>
                                    <sys:String>Name</sys:String>
                                </CollectionViewSource.LiveGroupingProperties>
                                <CollectionViewSource.LiveFilteringProperties>
                                    <sys:String>Name</sys:String>
                                </CollectionViewSource.LiveFilteringProperties>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="SpellsBySchoolCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Spells}"
                                                  IsLiveSortingRequested="True"
                                                  IsLiveGroupingRequested="True">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="School"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="School" />
                                </CollectionViewSource.GroupDescriptions>
                                <CollectionViewSource.LiveSortingProperties>
                                    <sys:String>School</sys:String>
                                    <sys:String>Name</sys:String>
                                </CollectionViewSource.LiveSortingProperties>
                                <CollectionViewSource.LiveGroupingProperties>
                                    <sys:String>School</sys:String>
                                </CollectionViewSource.LiveGroupingProperties>
                                <CollectionViewSource.LiveFilteringProperties>
                                    <sys:String>Name</sys:String>
                                </CollectionViewSource.LiveFilteringProperties>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <!--  Sort/Filter Options  -->
                        <Grid Grid.Row="0">
                            <ComboBox x:Name="PART_SortCombo"
                                      SelectedIndex="0">
                                <ComboBoxItem Tag="{Binding Source={StaticResource SpellsByNameCollection}}"
                                              Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                                <ComboBoxItem Tag="{Binding Source={StaticResource SpellsBySchoolCollection}}"
                                              Content="{Binding Source={x:Static resources:Resources.SchoolLabel}}" />
                            </ComboBox>
                        </Grid>
                        <!--  List of spells-->
                        <controls:FilterableList Grid.Row="2"
                                                 x:Name="PART_SpellList"
                                                 Filter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Filter}"
                                                 Items="{Binding ElementName=PART_SortCombo, Path=SelectedValue.Tag}"
                                                 SelectedItem="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedSpell}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!--  Control for editing spell data  -->
    <Style TargetType="{x:Type controls:SpellEditor}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:SpellEditor}">
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="SourcesCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Campaign.Sources}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                                      VerticalScrollBarVisibility="Auto"
                                      PanningMode="VerticalOnly">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label Grid.Row="0"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                                <TextBox Grid.Row="0"
                                         Grid.Column="1"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Name, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="1"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.SchoolLabel}}" />
                                <TextBox Grid.Row="1"
                                         Grid.Column="1"
                                         VerticalAlignment="Center"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.School, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="2"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.ShortDescriptionLabel}}" />
                                <TextBox Grid.Row="2"
                                         Grid.Column="1"
                                         Grid.ColumnSpan="2"
                                         VerticalAlignment="Center"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.ShortDescription, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="3"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.EffectTypesLabel}}" />
                                <controls:StringListEditor Grid.Row="3"
                                                           Grid.Column="1"
                                                           Template="{StaticResource {x:Static controls:ResourceKeys.StringListEditorSideBySideTemplate}}"
                                                           StringCollection="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.EffectTypes}"
                                                           Options="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Campaign.Spells.SpellEffectTypes}"
                                                           CanAddNew="True" />
                                <Label Grid.Row="4"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.SubschoolLabel}}" />
                                <TextBox Grid.Row="4"
                                         Grid.Column="1"
                                         VerticalAlignment="Center"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SubSchool, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="5"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.LevelLabel}}" />
                                <Grid Grid.Row="5"
                                      Grid.Column="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <ItemsControl VerticalAlignment="Center"
                                                  ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SpellLevels}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel Orientation="Horizontal"
                                                           IsItemsHost="True" />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="{Binding Class}" />
                                                    <TextBlock Grid.Column="1"
                                                               Margin="4, 0, 8, 0"
                                                               Text="{Binding Level}" />
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                    <Button Grid.Column="1"
                                            FontFamily="Segoe UI Symbol"
                                            VerticalAlignment="Center"
                                            Margin="4, 0"
                                            x:Name="PART_EditButton"
                                            Content="{Binding Source={x:Static resources:Resources.EditButton}}" />
                                </Grid>
                                <Label Grid.Row="6"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.CastingTimeLabel}}" />
                                <TextBox Grid.Row="6"
                                         Grid.Column="1"
                                         VerticalAlignment="Center"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.CastingTime, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="7"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.ComponentsLabel}}" />
                                <TextBox Grid.Row="7"
                                         Grid.Column="1"
                                         VerticalAlignment="Center"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Components, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="8"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.CostlyComponentsLabel}}" />
                                <TextBox Grid.Row="8"
                                         Grid.Column="1"
                                         VerticalAlignment="Center"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.CostlyComponents, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="9"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static vmresources:Resources.RangedLabel}}" />
                                <TextBox Grid.Row="9"
                                         Grid.Column="1"
                                         VerticalAlignment="Center"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Range, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="10"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.AreaLabel}}" />
                                <TextBox Grid.Row="10"
                                         Grid.Column="1"
                                         VerticalAlignment="Center"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Area, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="11"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.EffectLabel}}" />
                                <TextBox Grid.Row="11"
                                         Grid.Column="1"
                                         VerticalAlignment="Center"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Effect, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="12"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.TargetsLabel}}" />
                                <TextBox Grid.Row="12"
                                         Grid.Column="1"
                                         VerticalAlignment="Center"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Targets, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="13"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.DurationLabel}}" />
                                <TextBox Grid.Row="13"
                                         Grid.Column="1"
                                         VerticalAlignment="Center"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Duration, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="14"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.DismissibleLabel}}" />
                                <CheckBox Grid.Row="14"
                                          Grid.Column="1"
                                          VerticalAlignment="Center"
                                          IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Dismissible, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="15"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.ShapeableLabel}}" />
                                <CheckBox Grid.Row="15"
                                          Grid.Column="1"
                                          VerticalAlignment="Center"
                                          IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Shapeable, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="16"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.SpellResistanceLabel}}" />
                                <TextBox Grid.Row="16"
                                         Grid.Column="1"
                                         VerticalAlignment="Center"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SpellResistance, UpdateSourceTrigger=PropertyChanged}" />
                                <Label Grid.Row="17"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static resources:Resources.SourceLabel}}" />
                                <ComboBox Grid.Row="17"
                                          Grid.Column="1"
                                          VerticalAlignment="Center"
                                          IsEditable="True"
                                          Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Source, UpdateSourceTrigger=PropertyChanged}"
                                          SelectedItem="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Source, UpdateSourceTrigger=PropertyChanged}"
                                          ItemsSource="{Binding Source={StaticResource SourcesCollection}}" />
                                <Label Grid.Row="18"
                                       Grid.Column="0"
                                       Content="{Binding Source={x:Static vmresources:Resources.DescriptionLabel}}" />
                                <TextBox Grid.Row="18"
                                         Grid.Column="1"
                                         Grid.ColumnSpan="2"
                                         VerticalAlignment="Center"
                                         TextWrapping="Wrap"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Description, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                        </ScrollViewer>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:EditSpellLevels}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:EditSpellLevels}">
                    <Grid x:Name="rootGrid">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Button Grid.Row="0"
                                x:Name="PART_AddButton"
                                FontFamily="Segoe UI Symbol"
                                Content="{Binding Source={x:Static resources:Resources.AddButton}}"
                                HorizontalAlignment="Right" />
                        <ScrollViewer Grid.Row="1"
                                      VerticalScrollBarVisibility="Auto"
                                      HorizontalScrollBarVisibility="Disabled"
                                      PanningMode="VerticalOnly">
                            <ItemsControl ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Levels}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate DataType="{x:Type spells:SpellLevel}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition MinWidth="60" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="60" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Label Grid.Column="0"
                                                   Content="{Binding Source={x:Static resources:Resources.ClassLabel}}" />
                                            <ComboBox Grid.Column="1"
                                                      IsEditable="True"
                                                      VerticalAlignment="Center"
                                                      Text="{Binding Path=Class, UpdateSourceTrigger=PropertyChanged}"
                                                      ItemsSource="{Binding RelativeSource={RelativeSource AncestorType={x:Type controls:EditSpellLevels}}, Path=ViewModel.Classes}" />
                                            <Label Grid.Column="2"
                                                   Content="{Binding Source={x:Static resources:Resources.LevelLabel}}" />
                                            <TextBox Grid.Column="3"
                                                     Text="{Binding Path=Level, UpdateSourceTrigger=PropertyChanged}"
                                                     windows:TextBoxHelper.DataType="Integer" />
                                            <Button Grid.Column="4"
                                                    FontFamily="Segoe UI Symbol"
                                                    VerticalAlignment="Center"
                                                    MinWidth="0"
                                                    Margin="4, 0"
                                                    Content="{Binding Source={x:Static resources:Resources.RemoveButton}}" />
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:ManageSpellSchools}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ManageSpellSchools}">
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="SchoolsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Schools}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="SubSchoolsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SubSchools}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="EffectTypesCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.EffectTypes}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <!--  Schools  -->
                        <Grid Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <!--  Column for Schools  -->
                            <Label Grid.Row="0"
                                   HorizontalAlignment="Center"
                                   FontSize="{DynamicResource {x:Static controls:ResourceKeys.SubheaderFontSize}}"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.SchoolLabel}}" />
                            <ListBox Grid.Row="1"
                                     x:Name="PART_SchoolsList"
                                     ItemsSource="{Binding Source={StaticResource SchoolsCollection}}" />
                            <controls:AddRemoveEdit Grid.Row="2"
                                                    DataContext="Schools"
                                                    AllowEdit="True"
                                                    CommandParameter="{Binding ElementName=PART_SchoolsList, Path=SelectedValue}" />
                        </Grid>
                        <!--  SubSchools  -->
                        <Grid Grid.Column="1"
                              Margin="4, 0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <!--  Column for Schools  -->
                            <Label Grid.Row="0"
                                   HorizontalAlignment="Center"
                                   FontSize="{DynamicResource {x:Static controls:ResourceKeys.SubheaderFontSize}}"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.SubschoolLabel}}" />
                            <ListBox Grid.Row="1"
                                     x:Name="PART_SubSchoolsList"
                                     ItemsSource="{Binding Source={StaticResource SubSchoolsCollection}}" />
                            <controls:AddRemoveEdit Grid.Row="2"
                                                    DataContext="SubSchools"
                                                    AllowEdit="True"
                                                    CommandParameter="{Binding ElementName=PART_SubSchoolsList, Path=SelectedValue}" />
                        </Grid>
                        <!--  Effect Types  -->
                        <Grid Grid.Column="2">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <!--  Column for Schools  -->
                            <Label Grid.Row="0"
                                   HorizontalAlignment="Center"
                                   FontSize="{DynamicResource {x:Static controls:ResourceKeys.SubheaderFontSize}}"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.EffectTypesLabel}}" />
                            <ListBox Grid.Row="1"
                                     x:Name="PART_EffectTypesList"
                                     ItemsSource="{Binding Source={StaticResource EffectTypesCollection}}" />
                            <controls:AddRemoveEdit Grid.Row="2"
                                                    DataContext="EffectTypes"
                                                    AllowEdit="True"
                                                    CommandParameter="{Binding ElementName=PART_EffectTypesList, Path=SelectedValue}" />
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="{x:Type controls:ManageSources}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ManageSources}">
                    <Grid x:Name="RootGrid">
                        <Grid.Resources>
                            <CollectionViewSource x:Key="SourcesCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Sources}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="ItemsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Items}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="SourceType"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="SourceType" />
                                </CollectionViewSource.GroupDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="3*" />
                        </Grid.ColumnDefinitions>
                        <!--  List of Sources  -->
                        <Grid Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <ListBox x:Name="PART_SourceList"
                                     Grid.Row="0"
                                     ItemsSource="{Binding Source={StaticResource SourcesCollection}}"
                                     SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedSource}" />
                            <controls:AddRemoveEdit Grid.Row="1"
                                                    AllowAdd="False"
                                                    AllowEdit="True"
                                                    CommandParameter="{Binding ElementName=PART_SourceList, Path=SelectedValue}" />
                        </Grid>
                        <!--  Items from Selected Source  -->
                        <ListBox Grid.Column="1"
                                 x:Name="PART_ItemsList"
                                 Margin="8, 0, 4, 0"
                                 DisplayMemberPath="Name"
                                 ItemsSource="{Binding Source={StaticResource ItemsCollection}}">
                            <ListBox.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.HeaderTemplate>
                                        <DataTemplate>
                                            <Border BorderBrush="{StaticResource {x:Static controls:ResourceKeys.FadeToRightBrush}}"
                                                    BorderThickness="0,0,0,2">
                                                <TextBlock Text="{Binding Path=Name}"
                                                           FontSize="{StaticResource {x:Static controls:ResourceKeys.SubheaderFontSize}}"
                                                           Foreground="{StaticResource {x:Static controls:ResourceKeys.HeaderFontColor}}" />
                                            </Border>
                                        </DataTemplate>
                                    </GroupStyle.HeaderTemplate>
                                </GroupStyle>
                            </ListBox.GroupStyle>
                        </ListBox>
                        <!--  Selected item  -->
                        <ContentPresenter Grid.Column="2"
                                          Content="{Binding ElementName=PART_ItemsList, Path=SelectedValue}"
                                          ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.ObjectViewTemplate}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:GotoNextResults}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:GotoNextResults}">
                    <Grid>
                        <Grid.Resources>
                            <CollectionViewSource x:Key="EffectsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.ExpiredEffects}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Combatant.InitiativeOrder"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Effect.Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Label Grid.Row="0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               FontSize="{DynamicResource {x:Static controls:ResourceKeys.SubheaderFontSize}}"
                               Content="{Binding Source={x:Static resources:Resources.ExpiredEffectsInformationLabel}}" />
                        <ScrollViewer Grid.Row="1"
                                      VerticalScrollBarVisibility="Auto"
                                      HorizontalScrollBarVisibility="Disabled"
                                      PanningMode="VerticalOnly">
                            <ItemsControl ItemsSource="{Binding Source={StaticResource EffectsCollection}}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <ContentPresenter Content="{Binding Effect}"
                                                          ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.EffectNameTemplate}}" />
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:EditEffect}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:EditEffect}">
                    <Grid x:Name="RootGrid">
                        <Grid.Resources>
                            <CollectionViewSource x:Key="CombatantsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Combat.Combatants}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Ordinal"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*" />
                            <ColumnDefinition Width="3*" />
                        </Grid.ColumnDefinitions>
                        <!--  Various Inputs  -->
                        <Grid Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Label Grid.Row="0"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                            <TextBox Grid.Row="0"
                                     Grid.Column="1"
                                     VerticalAlignment="Center"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Name, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="1"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.SourceLabel}}" />
                            <ComboBox Grid.Row="1"
                                      Grid.Column="1"
                                      IsSynchronizedWithCurrentItem="False"
                                      ItemsSource="{Binding Source={StaticResource CombatantsCollection}}"
                                      SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Source}">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <controls:CombatantNamePanel Combatant="{Binding}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <Label Grid.Row="2"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.InitiativeSourceLabel}}" />
                            <ComboBox Grid.Row="2"
                                      Grid.Column="1"
                                      ItemsSource="{Binding Source={StaticResource CombatantsCollection}}"
                                      IsSynchronizedWithCurrentItem="False"
                                      SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.InitiativeSource}">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <controls:CombatantNamePanel Combatant="{Binding}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <Label Grid.Row="3"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.DurationLabel}}" />
                            <TextBox Grid.Row="3"
                                     Grid.Column="1"
                                     VerticalAlignment="Center"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Duration, UpdateSourceTrigger=PropertyChanged}"
                                     windows:TextBoxHelper.DataType="NonNegativeInteger" />
                            <Label Grid.Row="4"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.RemainingRoundsLabel}}" />
                            <TextBox Grid.Row="4"
                                     Grid.Column="1"
                                     VerticalAlignment="Center"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.RemainingRounds, UpdateSourceTrigger=PropertyChanged}"
                                     windows:TextBoxHelper.DataType="NonNegativeInteger" />
                            <Label Grid.Row="5"
                                   Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.RelatedEffectItemLabel}}" />
                            <Grid Grid.Row="5"
                                  Grid.Column="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBox Grid.Column="0"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.RelatedItem.Name, Converter={StaticResource CampaignObjectConverter}}"
                                         IsReadOnly="False" />
                                <Button Grid.Column="1"
                                        x:Name="PART_PickRelated"
                                        MinWidth="0"
                                        Padding="0, 4"
                                        VerticalAlignment="Center"
                                        Content="{Binding Source={x:Static resources:Resources.EllipsisButton}}"
                                        FontFamily="Segoe UI Symbol" />
                            </Grid>
                        </Grid>
                        <!--  List of Targets  -->
                        <Grid Grid.Column="1"
                              Margin="4, 0, 0, 0">
                            <Grid.Resources>
                                <CollectionViewSource x:Key="TargetsCollection"
                                                      Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Targets}">
                                    <CollectionViewSource.SortDescriptions>
                                        <comp:SortDescription PropertyName="Name"
                                                              Direction="Ascending" />
                                        <comp:SortDescription PropertyName="Ordinal"
                                                              Direction="Ascending" />
                                    </CollectionViewSource.SortDescriptions>
                                </CollectionViewSource>
                            </Grid.Resources>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Label Grid.Row="0"
                                   HorizontalAlignment="Center"
                                   Content="{Binding Source={x:Static resources:Resources.TargetsLabel}}" />
                            <ListBox Grid.Row="1"
                                     x:Name="PART_TargetsList"
                                     ItemsSource="{Binding Source={StaticResource TargetsCollection}}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <controls:CombatantNamePanel Combatant="{Binding}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <controls:AddRemoveEdit Grid.Row="2"
                                                    AllowEdit="False"
                                                    HorizontalAlignment="Right"
                                                    CommandParameter="{Binding ElementName=PART_TargetsList, Path=SelectedValue}" />
                        </Grid>
                        <GridSplitter Grid.Column="1"
                                      Style="{StaticResource {x:Static controls:ResourceKeys.HorizontalSplitterStyle}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:SelectCombatants}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:SelectCombatants}">
                    <Grid x:Name="RootGrid">
                        <Grid.Resources>
                            <CollectionViewSource x:Key="CombatantsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatants}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Ordinal"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <!--  Combatant List  -->
                        <ListBox x:Name="PART_CombatantList"
                                 ItemsSource="{Binding Source={StaticResource CombatantsCollection}}">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <controls:CombatantNamePanel Combatant="{Binding}" />
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="{x:Type controls:SelectCampaignObjects}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:SelectCampaignObjects}">
                    <Grid x:Name="RootGrid">
                        <Grid.Resources>
                            <CollectionViewSource x:Key="ItemsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Items}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="SourceType"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="SourceType" />
                                    <PropertyGroupDescription PropertyName="Name"
                                                              Converter="{StaticResource NameGroupingConverter}" />
                                </CollectionViewSource.GroupDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="2*" />
                        </Grid.ColumnDefinitions>
                        <!--  Filterable List  -->
                        <controls:FilterableList x:Name="PART_ItemsList"
                                                 SelectedItems="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedItems}"
                                                 Items="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Items}" />
                        <!--  Selected Item View  -->
                        <ContentPresenter Grid.Column="1"
                                          Content="{Binding ElementName=PART_ItemsList, Path=SelectedItem}"
                                          ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.ObjectViewTemplate}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="{x:Type controls:FilterableList}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:FilterableList}">
                    <Grid x:Name="PART_RootGrid">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Label Grid.Column="0"
                                   Content="{Binding Source={x:Static resources:Resources.FilterLabel}}" />
                            <TextBox Grid.Column="1"
                                     x:Name="PART_FilterText"
                                     IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Filter.HasFilter, Converter={StaticResource BooleanReverseConverter}, FallbackValue=True, TargetNullValue=True}"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=FilterText, UpdateSourceTrigger=PropertyChanged}" />
                            <Button Grid.Column="2"
                                    x:Name="PART_FilterButton"
                                    MinWidth="0"
                                    FontFamily="Segoe UI Symbol"
                                    VerticalAlignment="Center"
                                    Margin="4, 0, 0, 0"
                                    Visibility="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Filter, Converter={StaticResource ReferenceToVisibility}}"
                                    Content="{Binding Source={x:Static resources:Resources.FilterButton}}" />
                        </Grid>
                        <ListBox Grid.Row="1"
                                 x:Name="PART_List"
                                 ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Items}"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                 ScrollViewer.VerticalScrollBarVisibility="Auto"
                                 VirtualizingPanel.IsVirtualizingWhenGrouping="True"
                                 VirtualizingPanel.IsVirtualizing="True"
                                 SelectedItem="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedItem}">
                            <ListBox.GroupStyle>
                                <GroupStyle HeaderTemplate="{StaticResource {x:Static controls:ResourceKeys.GroupHeaderTemplate}}" />
                            </ListBox.GroupStyle>
                            <ListBox.Resources>
                                <DataTemplate DataType="{x:Type spells:Spell}">
                                    <ContentPresenter Content="{Binding}"
                                                      ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.SpellNameTemplate}}" />
                                </DataTemplate>
                                <DataTemplate DataType="{x:Type equipment:MagicItem}">
                                    <ContentPresenter Content="{Binding}"
                                                      ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.MagicItemNameTemplate}}" />
                                </DataTemplate>
                                <DataTemplate DataType="{x:Type monsters:Monster}">
                                    <ContentPresenter Content="{Binding}"
                                                      ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.MonsterNameTemplate}}" />
                                </DataTemplate>
                            </ListBox.Resources>
                        </ListBox>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="{x:Type controls:ManageMagicItems}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:ManageMagicItems}">
                    <Grid x:Name="PART_RootGrid">
                        <Grid.Resources>
                            <CollectionViewSource x:Key="ItemsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.MagicItems}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Group"
                                                          Direction="Ascending" />
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.GroupDescriptions>
                                    <PropertyGroupDescription PropertyName="Group" />
                                    <PropertyGroupDescription PropertyName="Name"
                                                              Converter="{StaticResource NameGroupingConverter}" />
                                </CollectionViewSource.GroupDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="3*" />
                        </Grid.ColumnDefinitions>
                        <controls:FilterableList Grid.Column="0"
                                                 x:Name="PART_List"
                                                 Filter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Filter}"
                                                 Items="{Binding Source={StaticResource ItemsCollection}}" />
                        <Grid Grid.Column="1"
                              Margin="4, 0, 0, 0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <controls:AddRemoveEdit Grid.Row="0"
                                                    AllowEdit="True"
                                                    AllowCopy="True"
                                                    CommandParameter="{Binding ElementName=PART_List, Path=SelectedItem}" />
                            <ScrollViewer Grid.Row="1"
                                          HorizontalScrollBarVisibility="Hidden"
                                          VerticalScrollBarVisibility="Auto"
                                          PanningMode="VerticalOnly">
                                <ContentPresenter Visibility="{Binding ElementName=PART_List, Path=SelectedItem, Converter={StaticResource ReferenceToVisibility}}"
                                                  Content="{Binding ElementName=PART_List, Path=SelectedItem}"
                                                  ContentTemplate="{StaticResource {x:Static controls:ResourceKeys.MagicItemTemplate}}" />
                            </ScrollViewer>
                        </Grid>
                        <GridSplitter Grid.Column="1"
                                      Style="{StaticResource {x:Static controls:ResourceKeys.HorizontalSplitterStyle}}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:MagicItemEditor}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:MagicItemEditor}">
                    <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                                  VerticalScrollBarVisibility="Auto"
                                  PanningMode="VerticalOnly">
                        <Grid x:Name="PART_RootGrid">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"
                                                  SharedSizeGroup="Labels" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Label Grid.Row="0"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                            <TextBox Grid.Row="0"
                                     Grid.Column="1"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Name, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="1"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static vmresources:Resources.GroupLabel}}" />
                            <ComboBox Grid.Row="1"
                                      Grid.Column="1"
                                      VerticalAlignment="Center"
                                      Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Group}"
                                      SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Group}"
                                      ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Campaign.EquipmentManager.Groups}" />
                            <Label Grid.Row="2"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.SlotLabel}}" />
                            <TextBox Grid.Row="2"
                                     Grid.Column="1"
                                     VerticalAlignment="Center"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Slot, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="3"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.WeightLabel}}" />
                            <TextBox Grid.Row="3"
                                     Grid.Column="1"
                                     VerticalAlignment="Center"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Weight, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="4"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.PriceLabel}}" />
                            <TextBox Grid.Row="4"
                                     Grid.Column="1"
                                     VerticalAlignment="Center"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.PriceInCopper, Converter={StaticResource MonetaryConverter}, ConverterParameter=gold}" />
                            <Border Grid.Row="5"
                                    Grid.ColumnSpan="2"
                                    BorderBrush="{DynamicResource {x:Static controls:ResourceKeys.FadeToRightBrush}}"
                                    BorderThickness="0, 0, 0, 2" />
                            <Label Grid.Row="6"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.CasterLevelLabel}}" />
                            <TextBox Grid.Row="6"
                                     Grid.Column="1"
                                     VerticalAlignment="Center"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.CasterLevel, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="7"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.RequirementsLabel}}" />
                            <TextBox Grid.Row="7"
                                     Grid.Column="1"
                                     VerticalAlignment="Center"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Requirements, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="8"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.CostLabel}}" />
                            <TextBox Grid.Row="8"
                                     Grid.Column="1"
                                     VerticalAlignment="Center"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.CostInCopper, Converter={StaticResource MonetaryConverter}, ConverterParameter=gold}" />
                            <Label Grid.Row="9"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.AurasLabel}}" />
                            <controls:StringListEditor Grid.Row="9"
                                                       Grid.Column="1"
                                                       StringCollection="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Auras}" />
                            <Label Grid.Row="10"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.AuraStrengthLabel}}" />
                            <TextBox Grid.Row="10"
                                     Grid.Column="1"
                                     VerticalAlignment="Center"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.AuraStrength, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="11"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.IsIntelligentLabel}}" />
                            <CheckBox Grid.Row="11"
                                      Grid.Column="1"
                                      IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.IsIntelligent}" />
                            <Border Grid.Row="12"
                                    Grid.ColumnSpan="2"
                                    BorderThickness="0, 2, 0, 2"
                                    BorderBrush="{StaticResource {x:Static controls:ResourceKeys.FadeToRightBrush}}">
                                <Grid IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.IsIntelligent}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"
                                                          SharedSizeGroup="Labels" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Label Grid.Row="0"
                                           Grid.Column="0"
                                           Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                           Content="{Binding Source={x:Static vmresources:Resources.AlignmentLabel}}" />
                                    <ComboBox Grid.Row="0"
                                              Grid.Column="1"
                                              VerticalAlignment="Center"
                                              SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Alignment}"
                                              ItemsSource="{Binding Source={x:Static controls:AlignmentExtensions.ItemsSource}}"
                                              DisplayMemberPath="Display"
                                              SelectedValuePath="Value" />
                                    <Label Grid.Row="1"
                                           Grid.Column="0"
                                           Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                           Content="{Binding Source={x:Static vmresources:Resources.IntelligenceLabel}}" />
                                    <TextBox Grid.Row="1"
                                             Grid.Column="1"
                                             VerticalAlignment="Center"
                                             windows:TextBoxHelper.DataType="Integer"
                                             Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Intelligence, UpdateSourceTrigger=PropertyChanged}" />
                                    <Label Grid.Row="2"
                                           Grid.Column="0"
                                           Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                           Content="{Binding Source={x:Static vmresources:Resources.WisdomLabel}}" />
                                    <TextBox Grid.Row="2"
                                             Grid.Column="1"
                                             windows:TextBoxHelper.DataType="Integer"
                                             VerticalAlignment="Center"
                                             Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Wisdom, UpdateSourceTrigger=PropertyChanged}" />
                                    <Label Grid.Row="3"
                                           Grid.Column="0"
                                           Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                           Content="{Binding Source={x:Static vmresources:Resources.CharismaLabel}}" />
                                    <TextBox Grid.Row="3"
                                             Grid.Column="1"
                                             windows:TextBoxHelper.DataType="Integer"
                                             VerticalAlignment="Center"
                                             Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Charisma, UpdateSourceTrigger=PropertyChanged}" />
                                    <Label Grid.Row="4"
                                           Grid.Column="0"
                                           Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                           Content="{Binding Source={x:Static resources:Resources.EgoLabel}}" />
                                    <TextBox Grid.Row="4"
                                             Grid.Column="1"
                                             VerticalAlignment="Center"
                                             windows:TextBoxHelper.DataType="Integer"
                                             Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Ego, UpdateSourceTrigger=PropertyChanged}" />
                                    <Label Grid.Row="5"
                                           Grid.Column="0"
                                           Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                           Content="{Binding Source={x:Static resources:Resources.CommunicationLabel}}" />
                                    <TextBox Grid.Row="5"
                                             Grid.Column="1"
                                             VerticalAlignment="Center"
                                             Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Communication, UpdateSourceTrigger=PropertyChanged}" />
                                    <Label Grid.Row="6"
                                           Grid.Column="0"
                                           Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                           Content="{Binding Source={x:Static vmresources:Resources.SensesLabel}}" />
                                    <TextBox Grid.Row="6"
                                             Grid.Column="1"
                                             VerticalAlignment="Center"
                                             Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Senses, UpdateSourceTrigger=PropertyChanged}" />
                                    <Label Grid.Row="7"
                                           Grid.Column="0"
                                           Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                           Content="{Binding Source={x:Static resources:Resources.PowersLabel}}" />
                                    <TextBox Grid.Row="7"
                                             Grid.Column="1"
                                             VerticalAlignment="Center"
                                             Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Powers, UpdateSourceTrigger=PropertyChanged}" />
                                    <Label Grid.Row="8"
                                           Grid.Column="0"
                                           Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                           Content="{Binding Source={x:Static vmresources:Resources.LanguagesLabel}}" />
                                    <TextBox Grid.Row="8"
                                             Grid.Column="1"
                                             VerticalAlignment="Center"
                                             Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Languages, UpdateSourceTrigger=PropertyChanged}" />
                                </Grid>
                            </Border>
                            <Label Grid.Row="13"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.ArtifactLevelLabel}}" />
                            <ComboBox Grid.Row="13"
                                      Grid.Column="1"
                                      VerticalAlignment="Center"
                                      SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.ArtifactLevel}"
                                      ItemsSource="{Binding Source={x:Static controls:ArtifactLevelExtensions.ItemsSource}}"
                                      DisplayMemberPath="Display"
                                      SelectedValuePath="Value" />
                            <Label Grid.Row="14"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.MythicLabel}}" />
                            <CheckBox Grid.Row="14"
                                      Grid.Column="1"
                                      IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Mythic}"
                                      IsEnabled="False" />
                            <Label Grid.Row="15"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static resources:Resources.SourceLabel}}" />
                            <ComboBox Grid.Row="15"
                                      Grid.Column="1"
                                      VerticalAlignment="Center"
                                      IsEditable="True"
                                      Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Source}"
                                      SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Source}"
                                      ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Campaign.Sources}" />
                            <Label Grid.Row="16"
                                   Grid.Column="0"
                                   Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                                   Content="{Binding Source={x:Static vmresources:Resources.DescriptionLabel}}" />
                            <TextBox Grid.Row="16"
                                     Grid.Column="1"
                                     VerticalAlignment="Center"
                                     TextWrapping="Wrap"
                                     Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Description, UpdateSourceTrigger=PropertyChanged}" />
                        </Grid>
                    </ScrollViewer>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:MonsterFilter}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:MonsterFilter}">
                    <Grid x:Name="PART_RootGrid">
                        <Grid.Resources>
                            <CollectionViewSource x:Key="GroupsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.GroupOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="TypesCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.TypeOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="SubTypesCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SubTypeOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Label Grid.Row="0"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                        <TextBox Grid.Row="0"
                                 Grid.Column="1"
                                 VerticalAlignment="Center"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Name, UpdateSourceTrigger=PropertyChanged}" />
                        <Label Grid.Row="1"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static vmresources:Resources.GroupLabel}}" />
                        <ComboBox Grid.Row="1"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Group, UpdateSourceTrigger=PropertyChanged}">
                            <ComboBox.ItemsSource>
                                <CompositeCollection>
                                    <CollectionContainer Collection="{Binding Source={StaticResource GroupsCollection}}" />
                                </CompositeCollection>
                            </ComboBox.ItemsSource>
                        </ComboBox>
                        <Label Grid.Row="2"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static vmresources:Resources.TypeLabel}}" />
                        <ComboBox Grid.Row="2"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Type, UpdateSourceTrigger=PropertyChanged}">
                            <ComboBox.ItemsSource>
                                <CompositeCollection>
                                    <CollectionContainer Collection="{Binding Source={StaticResource TypesCollection}}" />
                                </CompositeCollection>
                            </ComboBox.ItemsSource>
                        </ComboBox>
                        <Label Grid.Row="3"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static vmresources:Resources.SubtypesLabel}}" />
                        <controls:StringListEditor Grid.Row="3"
                                                   Grid.Column="1"
                                                   VerticalAlignment="Center"
                                                   Template="{StaticResource {x:Static controls:ResourceKeys.StringListEditorSideBySideTemplate}}"
                                                   Options="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SubTypeOptions}"
                                                   CanAddNew="False"
                                                   StringCollection="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SubTypes}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:SpellFilter}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:SpellFilter}">
                    <Grid x:Name="PART_RootGrid">
                        <Grid.Resources>
                            <CollectionViewSource x:Key="SchoolsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent},Path=ViewModel.SchoolOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="SubSchoolsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent},Path=ViewModel.SubSchoolOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="ClassesCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent},Path=ViewModel.ClassOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="CastingTimesCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent},Path=ViewModel.CastingTimeOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="RangesCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent},Path=ViewModel.RangeOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="AreasCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent},Path=ViewModel.AreaOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="SavingThrowsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent},Path=ViewModel.SavingThrowOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="SpellResistancesCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent},Path=ViewModel.SpellResistanceOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="EffectTypesCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent},Path=ViewModel.EffectTypeOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Label Grid.Row="0"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                        <TextBox Grid.Row="0"
                                 Grid.Column="1"
                                 VerticalAlignment="Center"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Name, UpdateSourceTrigger=PropertyChanged}" />
                        <Label Grid.Row="1"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.SchoolLabel}}" />
                        <ComboBox Grid.Row="1"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.School}">
                            <ComboBox.ItemsSource>
                                <CompositeCollection>
                                    <CollectionContainer Collection="{Binding Source={StaticResource SchoolsCollection}}" />
                                </CompositeCollection>
                            </ComboBox.ItemsSource>
                        </ComboBox>
                        <Label Grid.Row="2"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.SubschoolLabel}}" />
                        <ComboBox Grid.Row="2"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SubSchool}">
                            <ComboBox.ItemsSource>
                                <CompositeCollection>
                                    <CollectionContainer Collection="{Binding Source={StaticResource SubSchoolsCollection}}" />
                                </CompositeCollection>
                            </ComboBox.ItemsSource>
                        </ComboBox>
                        <Label Grid.Row="3"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.ClassLabel}}" />
                        <ComboBox Grid.Row="3"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Class}">
                            <ComboBox.ItemsSource>
                                <CompositeCollection>
                                    <CollectionContainer Collection="{Binding Source={StaticResource ClassesCollection}}" />
                                </CompositeCollection>
                            </ComboBox.ItemsSource>
                        </ComboBox>
                        <Label Grid.Row="4"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.LevelLabel}}" />
                        <TextBox Grid.Row="4"
                                 Grid.Column="1"
                                 VerticalAlignment="Center"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.ClassLevel, UpdateSourceTrigger=PropertyChanged}"
                                 windows:TextBoxHelper.DataType="Integer" />
                        <Label Grid.Row="5"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.CastingTimeLabel}}" />
                        <ComboBox Grid.Row="5"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.CastingTime}">
                            <ComboBox.ItemsSource>
                                <CompositeCollection>
                                    <CollectionContainer Collection="{Binding Source={StaticResource CastingTimesCollection}}" />
                                </CompositeCollection>
                            </ComboBox.ItemsSource>
                        </ComboBox>
                        <Label Grid.Row="6"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.RangeLabel}}" />
                        <ComboBox Grid.Row="6"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Range}">
                            <ComboBox.ItemsSource>
                                <CompositeCollection>
                                    <CollectionContainer Collection="{Binding Source={StaticResource RangesCollection}}" />
                                </CompositeCollection>
                            </ComboBox.ItemsSource>
                        </ComboBox>
                        <Label Grid.Row="7"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.AreaLabel}}" />
                        <ComboBox Grid.Row="7"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Area}">
                            <ComboBox.ItemsSource>
                                <CompositeCollection>
                                    <CollectionContainer Collection="{Binding Source={StaticResource AreasCollection}}" />
                                </CompositeCollection>
                            </ComboBox.ItemsSource>
                        </ComboBox>
                        <Label Grid.Row="8"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.SavingThrowLabel}}" />
                        <ComboBox Grid.Row="8"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SavingThrow}">
                            <ComboBox.ItemsSource>
                                <CompositeCollection>
                                    <CollectionContainer Collection="{Binding Source={StaticResource SavingThrowsCollection}}" />
                                </CompositeCollection>
                            </ComboBox.ItemsSource>
                        </ComboBox>
                        <Label Grid.Row="9"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.SpellResistanceLabel}}" />
                        <ComboBox Grid.Row="9"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SpellResistance}">
                            <ComboBox.ItemsSource>
                                <CompositeCollection>
                                    <CollectionContainer Collection="{Binding Source={StaticResource SpellResistancesCollection}}" />
                                </CompositeCollection>
                            </ComboBox.ItemsSource>
                        </ComboBox>
                        <Label Grid.Row="10"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.EffectTypesLabel}}" />
                        <controls:StringListEditor Grid.Row="10"
                                                   Grid.Column="1"
                                                   Template="{StaticResource {x:Static controls:ResourceKeys.StringListEditorSideBySideTemplate}}"
                                                   Options="{Binding Source={StaticResource EffectTypesCollection}}"
                                                   StringCollection="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.EffectTypes}"
                                                   CanAddNew="False" />
                        <Label Grid.Row="11"
                               Grid.Column="0"
                               Content="{Binding Source={x:Static resources:Resources.ShapeableLabel}}" />
                        <CheckBox Grid.Row="11"
                                  Grid.Column="1"
                                  IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Shapeable}"
                                  IsThreeState="True" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="{x:Type controls:MagicItemFilter}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:MagicItemFilter}">
                    <Grid x:Name="PART_RootGrid">
                        <Grid.Resources>
                            <CollectionViewSource x:Key="SlotsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.SlotOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="GroupsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.GroupOptions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="."
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Label Grid.Row="0"
                               Grid.Column="0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                        <TextBox Grid.Row="0"
                                 Grid.Column="1"
                                 VerticalAlignment="Center"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Name, UpdateSourceTrigger=PropertyChanged}" />
                        <Label Grid.Row="1"
                               Grid.Column="0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.CasterLevelLabel}}" />
                        <TextBox Grid.Row="1"
                                 Grid.Column="1"
                                 VerticalAlignment="Center"
                                 windows:TextBoxHelper.DataType="Integer"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.CasterLevel, UpdateSourceTrigger=PropertyChanged}" />
                        <Label Grid.Row="2"
                               Grid.Column="0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.SlotLabel}}" />
                        <ComboBox Grid.Row="2"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  IsSynchronizedWithCurrentItem="False"
                                  ItemsSource="{Binding Source={StaticResource SlotsCollection}}"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Slot}" />
                        <Label Grid.Row="3"
                               Grid.Column="0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static vmresources:Resources.GroupLabel}}" />
                        <ComboBox Grid.Row="3"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  IsSynchronizedWithCurrentItem="False"
                                  ItemsSource="{Binding Source={StaticResource GroupsCollection}}"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Group}" />
                        <Label Grid.Row="4"
                               Grid.Column="0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.MinimumPriceLabel}}" />
                        <TextBox Grid.Row="4"
                                 Grid.Column="1"
                                 VerticalAlignment="Center"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.MinimumPrice, Converter={StaticResource MonetaryConverter}, ConverterParameter=gold}" />
                        <Label Grid.Row="5"
                               Grid.Column="0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.MaximumPriceLabel}}" />
                        <TextBox Grid.Row="5"
                                 Grid.Column="1"
                                 VerticalAlignment="Center"
                                 Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.MaximumPrice, Converter={StaticResource MonetaryConverter}, ConverterParameter=gold}" />
                        <Label Grid.Row="6"
                               Grid.Column="0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.ArtifactLevelLabel}}" />
                        <ComboBox Grid.Row="6"
                                  Grid.Column="1"
                                  VerticalAlignment="Center"
                                  IsSynchronizedWithCurrentItem="False"
                                  ItemsSource="{Binding Source={x:Static controls:ArtifactLevelExtensions.ItemsSource}}"
                                  SelectedValuePath="Value"
                                  DisplayMemberPath="Display"
                                  SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.ArtifactLevel}" />
                        <Label Grid.Row="7"
                               Grid.Column="0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.IsIntelligentLabel}}" />
                        <CheckBox Grid.Row="7"
                                  Grid.Column="1"
                                  IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.IsIntelligent}" />
                        <Label Grid.Row="8"
                               Grid.Column="0"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.MythicLabel}}" />
                        <CheckBox Grid.Row="8"
                                  Grid.Column="1"
                                  IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ViewModel.Mythic}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="{x:Type controls:ConditionsManager}">
        <Style.Setters>
            <Setter Property="Focusable"
                    Value="False" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type controls:ConditionsManager}">
                        <Grid x:Name="PART_RootGrid">
                            <Grid.Resources>
                                <CollectionViewSource x:Key="ConditionsCollection"
                                                      Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Conditions.Conditions}"
                                                      IsLiveSortingRequested="True">
                                    <CollectionViewSource.SortDescriptions>
                                        <comp:SortDescription PropertyName="Name"
                                                              Direction="Ascending" />
                                    </CollectionViewSource.SortDescriptions>
                                </CollectionViewSource>
                            </Grid.Resources>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="400" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <!--  Selection List  -->
                            <Grid Grid.Column="0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <ListBox ItemsSource="{Binding Source={StaticResource ConditionsCollection}}"
                                         DisplayMemberPath="Name"
                                         SelectedValue="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCondition}" />
                                <controls:AddRemoveEdit Grid.Row="1"
                                                        AllowEdit="False"
                                                        AllowCopy="False" />
                            </Grid>
                            <Grid Grid.Column="1"
                                  IsEnabled="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCondition, Converter={StaticResource ReferenceToBoolean}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="10" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Row="0"
                                           Grid.Column="0"
                                           Text="{Binding Source={x:Static resources:Resources.NameLabel}}" />
                                <TextBox Grid.Row="0"
                                         Grid.Column="2"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCondition.Name, UpdateSourceTrigger=PropertyChanged}" />
                                <TextBlock Grid.Row="1"
                                           Grid.Column="0"
                                           Text="{Binding Source={x:Static resources:Resources.DescriptionLabel}}" />
                                <TextBox Grid.Row="1"
                                         Grid.Column="2"
                                         TextWrapping="Wrap"
                                         AcceptsReturn="True"
                                         Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedCondition.Description, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style.Setters>
    </Style>

    <!--  Effects Panel  -->
    <Style TargetType="{x:Type controls:EffectsPanel}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:EffectsPanel}">
                    <Grid x:Name="PART_EffectsPanel"
                          Margin="4, 0, 0, 0">
                        <Grid.Resources>
                            <!--  View for Effects targetting this combatant  -->
                            <CollectionViewSource x:Key="EffectsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combat.Effects}"
                                                  IsLiveSortingRequested="True">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                                <CollectionViewSource.LiveSortingProperties>
                                    <sys:String>Name</sys:String>
                                </CollectionViewSource.LiveSortingProperties>
                            </CollectionViewSource>
                            <CollectionViewSource x:Key="ConditionsCollection"
                                                  Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Combatant.Conditions}">
                                <CollectionViewSource.SortDescriptions>
                                    <comp:SortDescription PropertyName="Name"
                                                          Direction="Ascending" />
                                </CollectionViewSource.SortDescriptions>
                            </CollectionViewSource>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Label Grid.Row="0"
                               HorizontalAlignment="Center"
                               Foreground="{DynamicResource {x:Static controls:ResourceKeys.HeaderFontColor}}"
                               Content="{Binding Source={x:Static resources:Resources.EffectsLabel}}" />
                        <ListBox Grid.Row="1"
                                 x:Name="PART_SourceList">
                            <ListBox.ItemsSource>
                                <CompositeCollection>
                                    <CollectionContainer Collection="{Binding Source={StaticResource EffectsCollection}}" />
                                    <CollectionContainer Collection="{Binding Source={StaticResource ConditionsCollection}}" />
                                </CompositeCollection>
                            </ListBox.ItemsSource>
                            <ListBox.ItemContainerStyle>
                                <Style TargetType="{x:Type ListBoxItem}">
                                    <Setter Property="HorizontalContentAlignment"
                                            Value="Stretch" />
                                </Style>
                            </ListBox.ItemContainerStyle>
                            <ListBox.ItemTemplateSelector>
                                <windows:XamlTemplateSelector>
                                    <windows:XamlTemplateSelector.Templates>
                                        <windows:XamlTemplate Type="{x:Type combat:Effect}"
                                                              Template="{StaticResource ResourceKey={x:Static controls:ResourceKeys.EffectNameTemplate}}" />
                                        <windows:XamlTemplate Type="{x:Type combat:AppliedCondition}">
                                            <windows:XamlTemplate.Template>
                                                <DataTemplate>
                                                    <Grid Background="Transparent"
                                                          ToolTipService.ShowDuration="30000">
                                                        <Grid.ToolTip>
                                                            <TextBlock MaxWidth="1000"
                                                                       TextWrapping="Wrap"
                                                                       Text="{Binding Condition.Description}" />
                                                        </Grid.ToolTip>
                                                        <Grid.ContextMenu>
                                                            <ContextMenu>
                                                                <MenuItem Header="{Binding Source={x:Static resources:Resources.RemoveConditionMenuHeader}}"
                                                                          Command="local:Commands.RemoveCondition"
                                                                          CommandParameter="{Binding}" />
                                                            </ContextMenu>
                                                        </Grid.ContextMenu>
                                                        <TextBlock Text="{Binding Condition.Name}"
                                                                   TextTrimming="CharacterEllipsis" />
                                                    </Grid>
                                                </DataTemplate>
                                            </windows:XamlTemplate.Template>
                                        </windows:XamlTemplate>
                                    </windows:XamlTemplateSelector.Templates>
                                </windows:XamlTemplateSelector>
                            </ListBox.ItemTemplateSelector>
                        </ListBox>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  Damage Reduction List Editor  -->
    <Style TargetType="{x:Type controls:DamageReductionsEditor}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:DamageReductionsEditor}">
                    <Grid x:Name="PART_RootGrid">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <ListBox Grid.Row="0"
                                 x:Name="PART_List"
                                 ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DamageReductions.DamageReductions}">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Converter={StaticResource DamageReductionConverter}}" />
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                        <controls:AddRemoveEdit Grid.Row="1"
                                                AllowEdit="True"
                                                CommandParameter="{Binding ElementName=PART_List, Path=SelectedValue}" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!--  DataTemplate for editing damage reduction  -->
    <DataTemplate x:Key="{x:Static controls:ResourceKeys.EditDamageReductionTemplate}"
                  DataType="{x:Type vm:EditDamageReductionViewModel}">
        <Grid Grid.IsSharedSizeScope="True">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition SharedSizeGroup="Labels" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Label Grid.Row="0"
                   Grid.Column="0"
                   Content="{Binding Source={x:Static resources:Resources.AmountLabel}}" />
            <Label Grid.Row="1"
                   Grid.Column="0"
                   Content="{Binding Source={x:Static resources:Resources.RequiresAllLabel}}" />
            <Label Grid.Row="2"
                   Grid.Column="0"
                   Content="{Binding Source={x:Static resources:Resources.TypesLabel}}" />
            <TextBox Grid.Row="0"
                     Grid.Column="1"
                     VerticalAlignment="Center"
                     Text="{Binding Path=Amount, UpdateSourceTrigger=PropertyChanged}" />
            <CheckBox Grid.Row="1"
                      Grid.Column="1"
                      VerticalAlignment="Center"
                      IsChecked="{Binding Path=RequiresAllTypes}" />
            <controls:StringListEditor Grid.Row="3"
                                       Grid.ColumnSpan="2"
                                       StringCollection="{Binding Path=Types}" />
        </Grid>
    </DataTemplate>

    <!--  Damage Reduction Line with Ability to Edit  -->
    <Style TargetType="{x:Type controls:DamageReductionLine}">
        <Setter Property="Focusable"
                Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:DamageReductionLine}">
                    <Grid Grid.Row="10"
                          Grid.Column="1"
                          x:Name="PART_RootGrid">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DamageReduction, Converter={StaticResource DamageReductionConverter}}"
                                   TextWrapping="Wrap"
                                   Foreground="{StaticResource {x:Static controls:ResourceKeys.TextFontColor}}"
                                   VerticalAlignment="Center" />
                        <Button Grid.Column="1"
                                VerticalAlignment="Center"
                                Content="{Binding Source={x:Static resources:Resources.EditButton}}"
                                ToolTip="{Binding Source={x:Static resources:Resources.EditButtonToolTip}}"
                                Command="local:Commands.Edit"
                                FontFamily="Segoe UI Symbol" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
